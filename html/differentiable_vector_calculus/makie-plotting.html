<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">



<link
  href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css"
  rel="stylesheet">

<style>
.julia {display: block; font-family: "Source Code Pro";
        color:#0033CC;
        }
.hljl {font-family: "Source Code Pro";
        color:#0033CC;
        }
body { padding-top: 60px; }
h5:before {content:"\2746\ ";}
h6:before {content:"\2742\ ";}
pre {display: block;}
th, td {
  padding: 15px;
  text-align: left;
  border-bottom: 1px solid #ddd;
}
tr:hover {background-color: #f5f5f5;}

.admonition-title:before {content:"\2746\ ";}
.admonition-title { color:#0033CC}

</style>


<!-- .julia:before {content: "julia> "} -->

<style></style>


<script src="https://code.jquery.com/jquery.js"></script>


<script  type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [ ["\$","\$"], ["\\(","\\)"]]
  },
  displayAlign: "left",
  displayIndent: "5%"
});
</script>
<!-- not TeX-AMS-MML_HTMLorMML-->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script>
</script>


<script>
window.PlotlyConfig = {MathJaxConfig: 'local'}
</script>
<script src="https://cdn.plot.ly/plotly-latest.min.js"></script>


<script type="text/javascript">
$( document ).ready(function() {
  $("h1").each(function(index) {
       var title = $( this ).text()
       $("#page_title").html("<strong>" + title + "</strong>");
       document.title = title
  });
  $( "h2" ).each(function( index ) {
    var nm =  $( this ).text();
    var id = $.trim(nm).replace(/ /g,'');
    this.id = id
    $("#page_dropdown").append("<li><a href='#" + id + "'>" + nm + "</a></li>");
  });
  $('[data-toggle="popover"]').popover();
});
</script>

</head>


<body data-spy="scroll" >

<nav class="navbar navbar-default  navbar-fixed-top">
  <div class="container-fluid">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
         
    </div>

    <!-- Collect the nav links, forms, and other content for toggling -->
    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <ul class="nav navbar-nav">
        <li><a href="#" id="page_title"></a></li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
         <li class="dropdown">
           <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
           Jump to... <span class="caret"></span></a>
          <ul class="dropdown-menu" role="menu" id="page_dropdown"></ul>
        </li>
      </ul>
    </div><!-- /.navbar-collapse -->
  </div><!-- /.container-fluid -->
</nav>

<header>
</header>
          <div class="title">
            
            
            
          </div>



<div class="container-fluid">
  <div class="span10 offset1">
<h1>Calculus plots with Makie</h1>


<p>The <a href="https://github.com/JuliaPlots/Makie.jl">Makie.jl webpage</a> says</p>
<blockquote>
<p>From the Jpanese word Maki-e, which is a technique to sprinkle lacquer with gold and silver powder. Data is basically the gold and silver of our age, so let&#39;s spread it out beautifully on the screen&#33;</p>
</blockquote>
<p><code>Makie</code> itself is a metapackage for a rich ecosystem. We show how to use the interface provided by <code>AbstractPlotting</code> and the <code>GLMakie</code> backend to produce the familiar graphics of calculus.  We do not discuss the <code>MakieLayout</code> package which provides a means to layout multiple graphics and add widgets, such as sliders and buttons, to a layout. We do not discuss <code>MakieRecipes</code>. For <code>Plots</code>, there are &quot;recipes&quot; that make some of the plots more straightforward.  We do not discuss the <a href="https://github.com/JuliaPlots/AlgebraOfGraphics.jl"><code>AlgebraOfGraphics</code></a> which presents an interface for the familiar graphics of statistics. The <a href="https://github.com/JuliaPlots/MakieGallery.jl"><code>MakieGallery</code></a> shows many exmaples of the use of <code>Makie</code>.</p>
<h2>Scenes</h2>
<p>Makie draws graphics onto a canvas termed a &quot;scene&quot; in the Makie documentation. There are <code>GLMakie</code>, <code>WGLMakie</code>, and <code>CairoMakie</code> backends for different types of canvases. In the following, we have used <code>GLMakie</code>. <code>WGLMakie</code> is useful for incorporating <code>Makie</code> plots into web-based technologies.</p>
<p>We begin by loading our two packages:</p>


<pre class='hljl'>
<span class='hljl-k'>using</span><span class='hljl-t'> </span><span class='hljl-n'>AbstractPlotting</span><span class='hljl-t'>
</span><span class='hljl-k'>using</span><span class='hljl-t'> </span><span class='hljl-n'>GLMakie</span><span class='hljl-t'>
</span><span class='hljl-cs'>#using WGLMakie; WGLMakie.activate!()</span><span class='hljl-t'>
</span><span class='hljl-cs'>#AbstractPlotting.set_theme!(scale_figure=false, resolution = (480, 400))</span>
</pre>



<p>The <code>Makie</code> developers have workarounds for the delayed time to first plot, but without utilizing these the time to load the package is lengthy.</p>
<p>A scene is produced with <code>Scene&#40;&#41;</code> or through a plotting primitive:</p>


<pre class='hljl'>
<span class='hljl-n'>scene</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>Scene</span><span class='hljl-p'>()</span>
</pre>



<p>We see next how to move beyond the blank canvas.</p>
<h2>Points &#40;<code>scatter</code>&#41;</h2>
<p>The task of plotting the points, say <span class="math">$(1,2)$</span>, <span class="math">$(2,3)$</span>, <span class="math">$(3,2)$</span> can be done different ways. Most plotting packages, and <code>Makie</code> is no exception, allow the following: form vectors of the <span class="math">$x$</span> and <span class="math">$y$</span> values then plot those with <code>scatter</code>:</p>


<pre class='hljl'>
<span class='hljl-n'>xs</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>[</span><span class='hljl-ni'>1</span><span class='hljl-p'>,</span><span class='hljl-ni'>2</span><span class='hljl-p'>,</span><span class='hljl-ni'>3</span><span class='hljl-p'>]</span><span class='hljl-t'>
</span><span class='hljl-n'>ys</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>[</span><span class='hljl-ni'>2</span><span class='hljl-p'>,</span><span class='hljl-ni'>3</span><span class='hljl-p'>,</span><span class='hljl-ni'>2</span><span class='hljl-p'>]</span><span class='hljl-t'>
</span><span class='hljl-nf'>scatter</span><span class='hljl-p'>(</span><span class='hljl-n'>xs</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>ys</span><span class='hljl-p'>)</span>
</pre>



<p>The <code>scatter</code> function creates and returns a <code>Scene</code> object, which when displayed shows the plot.</p>
<p>The more generic <code>plot</code> function can also be used for this task.</p>
<h3><code>Point2</code>, <code>Point3</code></h3>
<p>When learning about points on the Cartesian plane, a &quot;<code>t</code>&quot;-chart is often produced:</p>
<pre><code>x | y
-----
1 | 2
2 | 3
3 | 2</code></pre>
<p>The <code>scatter</code> usage above used the columns. The rows are associated with the points, and these too can be used to produce the same graphic. Rather than make vectors of <span class="math">$x$</span> and <span class="math">$y$</span> &#40;and optionally <span class="math">$z$</span>&#41; coordinates, it is more idiomatic to create a vector of &quot;points.&quot; <code>Makie</code> utilizes a <code>Point</code> type to store a 2 or 3 dimensional point. The <code>Point2</code> and <code>Point3</code> constructors will be utilized. </p>
<p><code>Makie</code> uses a GPU, when present, to accelerate the graphic rendering. GPUs employ 32-bit numbers. Julia uses an <code>f0</code> to indicate 32-bit floating points. Hence the alternate types <code>Point2f0</code> to store 2D points as 32-bit numbers and <code>Points3f0</code> to store 3D points as 32-bit numbers are seen in the documentation for Makie.</p>
<p>We can plot vector of points in as direct manner as vectors of their coordinates:</p>


<pre class='hljl'>
<span class='hljl-n'>pts</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>[</span><span class='hljl-nf'>Point2</span><span class='hljl-p'>(</span><span class='hljl-ni'>1</span><span class='hljl-p'>,</span><span class='hljl-ni'>2</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-nf'>Point2</span><span class='hljl-p'>(</span><span class='hljl-ni'>2</span><span class='hljl-p'>,</span><span class='hljl-ni'>3</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-nf'>Point2</span><span class='hljl-p'>(</span><span class='hljl-ni'>3</span><span class='hljl-p'>,</span><span class='hljl-ni'>2</span><span class='hljl-p'>)]</span><span class='hljl-t'>
</span><span class='hljl-nf'>scatter</span><span class='hljl-p'>(</span><span class='hljl-n'>pts</span><span class='hljl-p'>)</span>
</pre>



<p>A typical usage is to generate points from some vector-valued function. Say we have a parameterized function <code>r</code> taking <span class="math">$R$</span> into <span class="math">$R^2$</span> defined by:</p>


<pre class='hljl'>
<span class='hljl-nf'>r</span><span class='hljl-p'>(</span><span class='hljl-n'>t</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>[</span><span class='hljl-nf'>sin</span><span class='hljl-p'>(</span><span class='hljl-n'>t</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-nf'>cos</span><span class='hljl-p'>(</span><span class='hljl-n'>t</span><span class='hljl-p'>)]</span>
</pre>


<pre class="output">
r &#40;generic function with 1 method&#41;
</pre>


<p>Then broadcasting values gives a vector of vectors, each identified with a point:</p>


<pre class='hljl'>
<span class='hljl-n'>ts</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>[</span><span class='hljl-ni'>1</span><span class='hljl-p'>,</span><span class='hljl-ni'>2</span><span class='hljl-p'>,</span><span class='hljl-ni'>3</span><span class='hljl-p'>]</span><span class='hljl-t'>
</span><span class='hljl-n'>r</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>ts</span><span class='hljl-p'>)</span>
</pre>


<pre class="output">
3-element Array&#123;Array&#123;Float64,1&#125;,1&#125;:
 &#91;0.8414709848078965, 0.5403023058681398&#93;
 &#91;0.9092974268256817, -0.4161468365471424&#93;
 &#91;0.1411200080598672, -0.9899924966004454&#93;
</pre>


<p>We can broadcast <code>Point2</code> over this to create a vector of <code>Point</code> objects:</p>


<pre class='hljl'>
<span class='hljl-n'>pts</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>Point2</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>r</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>ts</span><span class='hljl-p'>))</span>
</pre>


<pre class="output">
3-element Array&#123;GeometryBasics.Point&#123;2,Float64&#125;,1&#125;:
 &#91;0.8414709848078965, 0.5403023058681398&#93;
 &#91;0.9092974268256817, -0.4161468365471424&#93;
 &#91;0.1411200080598672, -0.9899924966004454&#93;
</pre>


<p>These then can be plotted directly:</p>


<pre class='hljl'>
<span class='hljl-nf'>scatter</span><span class='hljl-p'>(</span><span class='hljl-n'>pts</span><span class='hljl-p'>)</span>
</pre>



<p>The ploting of points in three dimesions is essentially the same, save the use of <code>Point3</code> instead of <code>Point2</code>.</p>


<pre class='hljl'>
<span class='hljl-nf'>r</span><span class='hljl-p'>(</span><span class='hljl-n'>t</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>[</span><span class='hljl-nf'>sin</span><span class='hljl-p'>(</span><span class='hljl-n'>t</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-nf'>cos</span><span class='hljl-p'>(</span><span class='hljl-n'>t</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-n'>t</span><span class='hljl-p'>]</span><span class='hljl-t'>
</span><span class='hljl-n'>ts</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>range</span><span class='hljl-p'>(</span><span class='hljl-ni'>0</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>4</span><span class='hljl-n'>pi</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>length</span><span class='hljl-oB'>=</span><span class='hljl-ni'>100</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>pts</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>Point3</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>r</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>ts</span><span class='hljl-p'>))</span><span class='hljl-t'>
</span><span class='hljl-nf'>scatter</span><span class='hljl-p'>(</span><span class='hljl-n'>pts</span><span class='hljl-p'>)</span>
</pre>



<hr />
<p>To plot points generated in terms of vectors of coordinates, the component vectors must be created.  The &quot;<code>t</code>&quot;-table shows how, simply loop over each column and add the corresponding <span class="math">$x$</span> or <span class="math">$y$</span> &#40;or <span class="math">$z$</span>&#41; value.  This utility function does exactly that, returning the vectors in a tuple.</p>


<pre class='hljl'>
<span class='hljl-nf'>unzip</span><span class='hljl-p'>(</span><span class='hljl-n'>vs</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>Tuple</span><span class='hljl-p'>([</span><span class='hljl-n'>vs</span><span class='hljl-p'>[</span><span class='hljl-n'>j</span><span class='hljl-p'>][</span><span class='hljl-n'>i</span><span class='hljl-p'>]</span><span class='hljl-t'> </span><span class='hljl-k'>for</span><span class='hljl-t'> </span><span class='hljl-n'>j</span><span class='hljl-t'> </span><span class='hljl-kp'>in</span><span class='hljl-t'> </span><span class='hljl-nf'>eachindex</span><span class='hljl-p'>(</span><span class='hljl-n'>vs</span><span class='hljl-p'>)]</span><span class='hljl-t'> </span><span class='hljl-k'>for</span><span class='hljl-t'> </span><span class='hljl-n'>i</span><span class='hljl-t'> </span><span class='hljl-kp'>in</span><span class='hljl-t'> </span><span class='hljl-nf'>eachindex</span><span class='hljl-p'>(</span><span class='hljl-n'>vs</span><span class='hljl-p'>[</span><span class='hljl-ni'>1</span><span class='hljl-p'>]))</span>
</pre>


<pre class="output">
unzip &#40;generic function with 1 method&#41;
</pre>


<p>&#40;The functionality is essentially a reverse of the <code>zip</code> function, hence the name.&#41;</p>
<p>We might have then:</p>


<pre class='hljl'>
<span class='hljl-nf'>scatter</span><span class='hljl-p'>(</span><span class='hljl-nf'>unzip</span><span class='hljl-p'>(</span><span class='hljl-n'>r</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>ts</span><span class='hljl-p'>))</span><span class='hljl-oB'>...</span><span class='hljl-p'>)</span>
</pre>



<p>where splatting is used to specify the <code>xs</code>, <code>ys</code>, and <code>zs</code> to <code>scatter</code>.</p>
<p>&#40;Compare to <code>scatter&#40;Point3.&#40;r.&#40;ts&#41;&#41;&#41;</code> or <code>scatter&#40;Point3∘r&#41;.&#40;ts&#41;&#41;</code>.&#41;</p>
<h3>Attributes</h3>
<p>A point is drawn with a &quot;marker&quot; with a certain size and color. These attributes can be adjusted, as in the following:</p>


<pre class='hljl'>
<span class='hljl-nf'>scatter</span><span class='hljl-p'>(</span><span class='hljl-n'>xs</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>ys</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>marker</span><span class='hljl-oB'>=</span><span class='hljl-p'>[</span><span class='hljl-sc'>:x</span><span class='hljl-p'>,</span><span class='hljl-oB'>:</span><span class='hljl-n'>cross</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-sc'>:circle</span><span class='hljl-p'>],</span><span class='hljl-t'> </span><span class='hljl-n'>markersize</span><span class='hljl-oB'>=</span><span class='hljl-ni'>25</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>color</span><span class='hljl-oB'>=:</span><span class='hljl-n'>blue</span><span class='hljl-p'>)</span>
</pre>



<p>Marker attributes include</p>
<ul>
<li><p><code>marker</code> a symbol, shape. A single value will be repeated. A vector of values of a matching size will specify a marker for each point.</p>
</li>
<li><p><code>marker_offset</code> offset coordinates</p>
</li>
<li><p><code>markersize</code> size &#40;radius pixels&#41; of marker</p>
</li>
</ul>
<h3>Text &#40;<code>text</code>&#41;</h3>
<p>Text can be placed at a point, as a marker is. To place text the desired text and a position need to be specified.</p>
<p>For example:</p>


<pre class='hljl'>
<span class='hljl-n'>pts</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>Point2</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-ni'>1</span><span class='hljl-oB'>:</span><span class='hljl-ni'>5</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-oB'>:</span><span class='hljl-ni'>5</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>scene</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>scatter</span><span class='hljl-p'>(</span><span class='hljl-n'>pts</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-p'>[</span><span class='hljl-nf'>text!</span><span class='hljl-p'>(</span><span class='hljl-n'>scene</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-s'>&quot;text&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>position</span><span class='hljl-oB'>=</span><span class='hljl-n'>pt</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>textsize</span><span class='hljl-oB'>=</span><span class='hljl-ni'>1</span><span class='hljl-oB'>/</span><span class='hljl-n'>i</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>rotation</span><span class='hljl-oB'>=</span><span class='hljl-ni'>2</span><span class='hljl-n'>pi</span><span class='hljl-oB'>/</span><span class='hljl-n'>i</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-k'>for</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-n'>i</span><span class='hljl-p'>,</span><span class='hljl-n'>pt</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-kp'>in</span><span class='hljl-t'> </span><span class='hljl-nf'>enumerate</span><span class='hljl-p'>(</span><span class='hljl-n'>pts</span><span class='hljl-p'>)]</span><span class='hljl-t'>
</span><span class='hljl-n'>scene</span>
</pre>



<p>The graphic shows that <code>position</code> positions the text, <code>textsize</code> adjusts the displayed size, and <code>rotation</code> adjusts the orientation.</p>
<p>Attributes for <code>text</code> include:</p>
<ul>
<li><p><code>position</code> to indicate the position. Either a <code>Point</code> object, as above, or a tuple</p>
</li>
<li><p><code>align</code> Specify the text alignment through <code>&#40;:pos, :pos&#41;</code>, where <code>:pos</code> can be <code>:left</code>, <code>:center</code>, or <code>:right</code>.</p>
</li>
<li><p><code>rotation</code> to indicate how the text is to be rotated</p>
</li>
<li><p><code>textsize</code> the font point size for the text</p>
</li>
<li><p><code>font</code> to indicate the desired font</p>
</li>
</ul>
<h2>Curves</h2>
<h3>Plots of univariate functions</h3>
<p>The basic plot of univariate calculus is the graph of a function <span class="math">$f$</span> over an interval <span class="math">$[a,b]$</span>. This is implemented using a familiar strategy: produce a series of representative values between <span class="math">$a$</span> and <span class="math">$b$</span>; produce the corresponding <span class="math">$f(x)$</span> values; plot these as points and connect the points with straight lines. The <code>lines</code> function of <code>AbstractPlotting</code> will do the last step.</p>
<p>By taking a sufficient number of points within <span class="math">$[a,b]$</span> the connect-the-dot figure will appear curved, when the function is.</p>
<p>To create regular values between <code>a</code> and <code>b</code> either the <code>range</code> function, the related <code>LinRange</code> function, or the range operator &#40;<code>a:h:b</code>&#41; are employed.</p>
<p>For example:</p>


<pre class='hljl'>
<span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>sin</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>a</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>b</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-ni'>0</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>2</span><span class='hljl-n'>pi</span><span class='hljl-t'>
</span><span class='hljl-n'>xs</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>range</span><span class='hljl-p'>(</span><span class='hljl-n'>a</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>b</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>length</span><span class='hljl-oB'>=</span><span class='hljl-ni'>250</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>lines</span><span class='hljl-p'>(</span><span class='hljl-n'>xs</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>f</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>xs</span><span class='hljl-p'>))</span>
</pre>



<p>Or</p>


<pre class='hljl'>
<span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>cos</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>a</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>b</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-n'>pi</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>pi</span><span class='hljl-t'>
</span><span class='hljl-n'>xs</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>a</span><span class='hljl-oB'>:</span><span class='hljl-n'>pi</span><span class='hljl-oB'>/</span><span class='hljl-ni'>100</span><span class='hljl-oB'>:</span><span class='hljl-n'>b</span><span class='hljl-t'>
</span><span class='hljl-nf'>lines</span><span class='hljl-p'>(</span><span class='hljl-n'>xs</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>f</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>xs</span><span class='hljl-p'>))</span>
</pre>



<p>As with <code>scatter</code>, <code>lines</code> returns a <code>Scene</code> object that produces a graphic when displayed.</p>
<p>As with <code>scatter</code>, <code>lines</code> can can also be drawn using a vector of points:</p>
<pre><code class="language-juila">lines&#40;&#91;Point2&#40;x, fx&#41; for &#40;x,fx&#41; in zip&#40;xs, f.&#40;xs&#41;&#41;&#93;&#41;</code></pre>
<p>&#40;Though the advantage isn&#39;t clear here, this will be useful when the points are more naturally generated.&#41;</p>
<p>When a <code>y</code> value is <code>NaN</code> or infinite, the connecting lines are not drawn:</p>
<pre><code>xs &#61; 1:5
ys &#61; &#91;1,2,NaN, 4, 5&#93;
lines&#40;xs, ys&#41;</code></pre>
<p>As with other plotting packages, this is useful to represent discontinuous functions, such as what occurs at a vertical asymptote.</p>
<h4>Adding to a scene &#40;<code>lines&#33;</code>, <code>scatter&#33;</code>, ...&#41;</h4>
<p>To <em>add</em> or <em>modify</em> a scene can be done using a mutating version of a plotting primitive, such as <code>lines&#33;</code> or <code>scatter&#33;</code>. The names follow <code>Julia</code>&#39;s convention of using an <code>&#33;</code> to indicate that a function modifies an argument, in this case the scene.</p>
<p>Here is one way to show two plots at once:</p>


<pre class='hljl'>
<span class='hljl-n'>xs</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>range</span><span class='hljl-p'>(</span><span class='hljl-ni'>0</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>2</span><span class='hljl-n'>pi</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>length</span><span class='hljl-oB'>=</span><span class='hljl-ni'>100</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>scene</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>lines</span><span class='hljl-p'>(</span><span class='hljl-n'>xs</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>sin</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>xs</span><span class='hljl-p'>))</span><span class='hljl-t'>
</span><span class='hljl-nf'>lines!</span><span class='hljl-p'>(</span><span class='hljl-n'>scene</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>xs</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>cos</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>xs</span><span class='hljl-p'>))</span>
</pre>



<p>We will see soon how to modify the line attributes so that the curves can be distinguished.</p>
<p>The following shows the construction details in the graphic, and that  the initial scene argument is implicitly assumed:</p>


<pre class='hljl'>
<span class='hljl-n'>xs</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>range</span><span class='hljl-p'>(</span><span class='hljl-ni'>0</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>2</span><span class='hljl-n'>pi</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>length</span><span class='hljl-oB'>=</span><span class='hljl-ni'>10</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>lines</span><span class='hljl-p'>(</span><span class='hljl-n'>xs</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>sin</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>xs</span><span class='hljl-p'>))</span><span class='hljl-t'>
</span><span class='hljl-nf'>scatter!</span><span class='hljl-p'>(</span><span class='hljl-n'>xs</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>sin</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>xs</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-n'>markersize</span><span class='hljl-oB'>=</span><span class='hljl-ni'>10</span><span class='hljl-p'>)</span>
</pre>



<hr />
<p>The current scene will have data limits that can be of interest. The following indicates how they can be manipulated to get the limits of the displayed <code>x</code> values.</p>


<pre class='hljl'>
<span class='hljl-n'>xs</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>range</span><span class='hljl-p'>(</span><span class='hljl-ni'>0</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>2</span><span class='hljl-n'>pi</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>length</span><span class='hljl-oB'>=</span><span class='hljl-ni'>200</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>scene</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>plot</span><span class='hljl-p'>(</span><span class='hljl-n'>xs</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>sin</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>xs</span><span class='hljl-p'>))</span><span class='hljl-t'>
</span><span class='hljl-n'>rect</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>scene</span><span class='hljl-oB'>.</span><span class='hljl-n'>data_limits</span><span class='hljl-p'>[]</span><span class='hljl-t'> </span><span class='hljl-cs'># get limits for g from f</span><span class='hljl-t'>
</span><span class='hljl-n'>a</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>b</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>rect</span><span class='hljl-oB'>.</span><span class='hljl-n'>origin</span><span class='hljl-p'>[</span><span class='hljl-ni'>1</span><span class='hljl-p'>],</span><span class='hljl-t'>  </span><span class='hljl-n'>rect</span><span class='hljl-oB'>.</span><span class='hljl-n'>origin</span><span class='hljl-p'>[</span><span class='hljl-ni'>1</span><span class='hljl-p'>]</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-n'>rect</span><span class='hljl-oB'>.</span><span class='hljl-n'>widths</span><span class='hljl-p'>[</span><span class='hljl-ni'>1</span><span class='hljl-p'>]</span>
</pre>


<pre class="output">
&#40;-0.9633175f0, 6.2831855f0&#41;
</pre>


<p>In the output it can be discerned that the values are 32-bit floating point numbers <em>and</em> yield a  slightly larger interval than specified in <code>xs</code>.</p>
<p>As an example, this shows how to add the tangent line to a graph. The slope of the tangent line being computed by <code>ForwardDiff.derivative</code>.</p>


<pre class='hljl'>
<span class='hljl-k'>using</span><span class='hljl-t'> </span><span class='hljl-n'>ForwardDiff</span><span class='hljl-t'>
</span><span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>x</span><span class='hljl-oB'>^</span><span class='hljl-n'>x</span><span class='hljl-t'>
</span><span class='hljl-n'>a</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>b</span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-ni'>0</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>2</span><span class='hljl-t'>
</span><span class='hljl-n'>c</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nfB'>0.5</span><span class='hljl-t'>
</span><span class='hljl-n'>xs</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>range</span><span class='hljl-p'>(</span><span class='hljl-n'>a</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>b</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>length</span><span class='hljl-oB'>=</span><span class='hljl-ni'>200</span><span class='hljl-p'>)</span><span class='hljl-t'>

</span><span class='hljl-nf'>tl</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>c</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-n'>ForwardDiff</span><span class='hljl-oB'>.</span><span class='hljl-nf'>derivative</span><span class='hljl-p'>(</span><span class='hljl-n'>f</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>c</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-oB'>-</span><span class='hljl-n'>c</span><span class='hljl-p'>)</span><span class='hljl-t'>

</span><span class='hljl-n'>scene</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>lines</span><span class='hljl-p'>(</span><span class='hljl-n'>xs</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>f</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>xs</span><span class='hljl-p'>))</span><span class='hljl-t'>
</span><span class='hljl-nf'>lines!</span><span class='hljl-p'>(</span><span class='hljl-n'>scene</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>xs</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>tl</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>xs</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-n'>color</span><span class='hljl-oB'>=:</span><span class='hljl-n'>blue</span><span class='hljl-p'>)</span>
</pre>



<h4>Attributes</h4>
<p>In the last example, we added the argument <code>color&#61;:blue</code> to the <code>lines&#33;</code> call. This set an attribute for the line being drawn. Lines have other attributes that allow different ones to be distinguished, as above where colors indicate the different graphs.</p>
<p>Other attributes can be seen from the help page for <code>lines</code>, and include:</p>
<ul>
<li><p><code>color</code> set with a symbol, as above, or a string</p>
</li>
<li><p><code>linestyle</code> available styles are set by a symbol, one of <code>:dash</code>, <code>:dot</code>, <code>:dashdot</code>, or <code>:dashdotdot</code>.</p>
</li>
<li><p><code>linewidth</code> width of line</p>
</li>
<li><p><code>transparency</code> the <code>alpha</code> value, a number between <span class="math">$0$</span> and <span class="math">$1$</span>, smaller numbers for more transparent.</p>
</li>
</ul>
<p>A legend can also be used to help identify different curves on the same graphic, though this is not illustrated. There are examples in the Makie gallery.</p>
<h4>Scene attributes</h4>
<p>Attributes of the scene include any titles and labels, the limits that define the coordinates being displayed, the presentation of tick marks, etc.</p>
<p>The <code>title</code> function can be used to add a title to a scene. The calling syntax is <code>title&#40;scene, text&#41;</code>.</p>
<p>To set the labels of the graph, there are &quot;shorthand&quot; functions <code>xlabel&#33;</code>, <code>ylabel&#33;</code>, and <code>zlabel&#33;</code>. The calling pattern would follow <code>xlabel&#33;&#40;scene, &quot;x-axis&quot;&#41;</code>.</p>
<p>The plotting ticks and their labels are returned by the unexported functions <code>tickranges</code> and <code>ticklabels</code>. The unexported <code>xtickrange</code>, <code>ytickrange</code>, and <code>ztickrange</code>; and <code>xticklabels</code>, <code>yticklabels</code>, and <code>zticklabels</code> return these for the indicated axes.</p>
<p>These can be dynamically adjusted using <code>xticks&#33;</code>, <code>yticks&#33;</code>, or <code>zticks&#33;</code>.</p>


<pre class='hljl'>
<span class='hljl-n'>pts</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>[</span><span class='hljl-nf'>Point2</span><span class='hljl-p'>(</span><span class='hljl-ni'>1</span><span class='hljl-p'>,</span><span class='hljl-ni'>2</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-nf'>Point2</span><span class='hljl-p'>(</span><span class='hljl-ni'>2</span><span class='hljl-p'>,</span><span class='hljl-ni'>3</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-nf'>Point2</span><span class='hljl-p'>(</span><span class='hljl-ni'>3</span><span class='hljl-p'>,</span><span class='hljl-ni'>2</span><span class='hljl-p'>)]</span><span class='hljl-t'>
</span><span class='hljl-n'>scene</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>scatter</span><span class='hljl-p'>(</span><span class='hljl-n'>pts</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>title</span><span class='hljl-p'>(</span><span class='hljl-n'>scene</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-s'>&quot;3 points&quot;</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>ylabel!</span><span class='hljl-p'>(</span><span class='hljl-n'>scene</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-s'>&quot;y values&quot;</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>xticks!</span><span class='hljl-p'>(</span><span class='hljl-n'>scene</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>xtickrange</span><span class='hljl-oB'>=</span><span class='hljl-p'>[</span><span class='hljl-ni'>1</span><span class='hljl-p'>,</span><span class='hljl-ni'>2</span><span class='hljl-p'>,</span><span class='hljl-ni'>3</span><span class='hljl-p'>],</span><span class='hljl-t'> </span><span class='hljl-n'>xticklabels</span><span class='hljl-oB'>=</span><span class='hljl-p'>[</span><span class='hljl-s'>&quot;a&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-s'>&quot;b&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-s'>&quot;c&quot;</span><span class='hljl-p'>])</span>
</pre>



<p>To set the limits of the graph there are shorthand functions <code>xlims&#33;</code>, <code>ylims&#33;</code>, and <code>zlims&#33;</code>. This might prove useful if vertical asymptotes are encountered, as in this example:</p>


<pre class='hljl'>
<span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-oB'>/</span><span class='hljl-n'>x</span><span class='hljl-t'>
</span><span class='hljl-n'>a</span><span class='hljl-p'>,</span><span class='hljl-n'>b</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-ni'>1</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-t'>
</span><span class='hljl-n'>xs</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>range</span><span class='hljl-p'>(</span><span class='hljl-oB'>-</span><span class='hljl-ni'>1</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>length</span><span class='hljl-oB'>=</span><span class='hljl-ni'>200</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>scene</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>lines</span><span class='hljl-p'>(</span><span class='hljl-n'>xs</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>f</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>xs</span><span class='hljl-p'>))</span><span class='hljl-t'>
</span><span class='hljl-nf'>ylims!</span><span class='hljl-p'>(</span><span class='hljl-n'>scene</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-oB'>-</span><span class='hljl-ni'>10</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>10</span><span class='hljl-p'>))</span><span class='hljl-t'>
</span><span class='hljl-nf'>center!</span><span class='hljl-p'>(</span><span class='hljl-n'>scene</span><span class='hljl-p'>)</span>
</pre>



<h3>Plots of parametric functions</h3>
<p>A space curve is a plot of a function <span class="math">$f:R^2 \rightarrow R$</span> or <span class="math">$f:R^3 \rightarrow R$</span>. </p>
<p>To construct a curve from a set of points, we have a similar pattern in both <span class="math">$2$</span> and <span class="math">$3$</span> dimensions:</p>


<pre class='hljl'>
<span class='hljl-nf'>r</span><span class='hljl-p'>(</span><span class='hljl-n'>t</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>[</span><span class='hljl-nf'>sin</span><span class='hljl-p'>(</span><span class='hljl-ni'>2</span><span class='hljl-n'>t</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-nf'>cos</span><span class='hljl-p'>(</span><span class='hljl-ni'>3</span><span class='hljl-n'>t</span><span class='hljl-p'>)]</span><span class='hljl-t'>
</span><span class='hljl-n'>ts</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>range</span><span class='hljl-p'>(</span><span class='hljl-ni'>0</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>2</span><span class='hljl-n'>pi</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>length</span><span class='hljl-oB'>=</span><span class='hljl-ni'>200</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>pts</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>Point2</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>r</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>ts</span><span class='hljl-p'>))</span><span class='hljl-t'>  </span><span class='hljl-cs'># or (Point2∘r).(ts)</span><span class='hljl-t'>
</span><span class='hljl-nf'>lines</span><span class='hljl-p'>(</span><span class='hljl-n'>pts</span><span class='hljl-p'>)</span>
</pre>



<p>Or </p>


<pre class='hljl'>
<span class='hljl-nf'>r</span><span class='hljl-p'>(</span><span class='hljl-n'>t</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>[</span><span class='hljl-nf'>sin</span><span class='hljl-p'>(</span><span class='hljl-ni'>2</span><span class='hljl-n'>t</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-nf'>cos</span><span class='hljl-p'>(</span><span class='hljl-ni'>3</span><span class='hljl-n'>t</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-n'>t</span><span class='hljl-p'>]</span><span class='hljl-t'>
</span><span class='hljl-n'>ts</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>range</span><span class='hljl-p'>(</span><span class='hljl-ni'>0</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>2</span><span class='hljl-n'>pi</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>length</span><span class='hljl-oB'>=</span><span class='hljl-ni'>200</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>pts</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>Point3</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>r</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>ts</span><span class='hljl-p'>))</span><span class='hljl-t'>
</span><span class='hljl-nf'>lines</span><span class='hljl-p'>(</span><span class='hljl-n'>pts</span><span class='hljl-p'>)</span>
</pre>



<p>Alternatively, vectors of the <span class="math">$x$</span>, <span class="math">$y$</span>, and <span class="math">$z$</span> components can be produced and then plotted using the pattern <code>lines&#40;xs, ys&#41;</code> or <code>lines&#40;xs, ys, zs&#41;</code>. For example, using <code>unzip</code>, as above, we might have done the prior example with:</p>


<pre class='hljl'>
<span class='hljl-n'>xs</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>ys</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>zs</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>unzip</span><span class='hljl-p'>(</span><span class='hljl-n'>r</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>ts</span><span class='hljl-p'>))</span><span class='hljl-t'>
</span><span class='hljl-nf'>lines</span><span class='hljl-p'>(</span><span class='hljl-n'>xs</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>ys</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>zs</span><span class='hljl-p'>)</span>
</pre>



<h4>Tangent vectors &#40;<code>arrows</code>&#41;</h4>
<p>A tangent vector along a curve can be drawn quite easily using the <code>arrows</code> function. There are different interfaces for <code>arrows</code>, but we show the one which uses a vector of positions and a vector of &quot;vectors&quot;. For the latter, we utilize the <code>derivative</code> function from <code>ForwardDiff</code>:</p>


<pre class='hljl'>
<span class='hljl-k'>using</span><span class='hljl-t'> </span><span class='hljl-n'>ForwardDiff</span><span class='hljl-t'>
</span><span class='hljl-nf'>r</span><span class='hljl-p'>(</span><span class='hljl-n'>t</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>[</span><span class='hljl-nf'>sin</span><span class='hljl-p'>(</span><span class='hljl-n'>t</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-nf'>cos</span><span class='hljl-p'>(</span><span class='hljl-n'>t</span><span class='hljl-p'>)]</span><span class='hljl-t'> </span><span class='hljl-cs'># vector, not tuple</span><span class='hljl-t'>
</span><span class='hljl-n'>ts</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>range</span><span class='hljl-p'>(</span><span class='hljl-ni'>0</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>4</span><span class='hljl-n'>pi</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>length</span><span class='hljl-oB'>=</span><span class='hljl-ni'>200</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>scene</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>Scene</span><span class='hljl-p'>()</span><span class='hljl-t'>
</span><span class='hljl-nf'>lines!</span><span class='hljl-p'>(</span><span class='hljl-n'>scene</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>Point2</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>r</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>ts</span><span class='hljl-p'>)))</span><span class='hljl-t'>

</span><span class='hljl-n'>nts</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-ni'>0</span><span class='hljl-oB'>:</span><span class='hljl-n'>pi</span><span class='hljl-oB'>/</span><span class='hljl-ni'>4</span><span class='hljl-oB'>:</span><span class='hljl-ni'>2</span><span class='hljl-n'>pi</span><span class='hljl-t'>
</span><span class='hljl-n'>us</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>r</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>nts</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>dus</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>ForwardDiff</span><span class='hljl-oB'>.</span><span class='hljl-n'>derivative</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>r</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>nts</span><span class='hljl-p'>)</span><span class='hljl-t'>

</span><span class='hljl-nf'>arrows!</span><span class='hljl-p'>(</span><span class='hljl-n'>scene</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>Point2</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>us</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-n'>Point2</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>dus</span><span class='hljl-p'>))</span>
</pre>



<p>In 3 dimensions the differences are minor:</p>


<pre class='hljl'>
<span class='hljl-nf'>r</span><span class='hljl-p'>(</span><span class='hljl-n'>t</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>[</span><span class='hljl-nf'>sin</span><span class='hljl-p'>(</span><span class='hljl-n'>t</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-nf'>cos</span><span class='hljl-p'>(</span><span class='hljl-n'>t</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-n'>t</span><span class='hljl-p'>]</span><span class='hljl-t'> </span><span class='hljl-cs'># vector, not tuple</span><span class='hljl-t'>
</span><span class='hljl-n'>ts</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>range</span><span class='hljl-p'>(</span><span class='hljl-ni'>0</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>4</span><span class='hljl-n'>pi</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>length</span><span class='hljl-oB'>=</span><span class='hljl-ni'>200</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>scene</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>Scene</span><span class='hljl-p'>()</span><span class='hljl-t'>
</span><span class='hljl-nf'>lines!</span><span class='hljl-p'>(</span><span class='hljl-n'>scene</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>Point3</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>r</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>ts</span><span class='hljl-p'>)))</span><span class='hljl-t'>

</span><span class='hljl-n'>nts</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>pi</span><span class='hljl-oB'>:</span><span class='hljl-n'>pi</span><span class='hljl-oB'>/</span><span class='hljl-ni'>4</span><span class='hljl-oB'>:</span><span class='hljl-ni'>3</span><span class='hljl-n'>pi</span><span class='hljl-t'>
</span><span class='hljl-n'>us</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>r</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>nts</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>dus</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>ForwardDiff</span><span class='hljl-oB'>.</span><span class='hljl-n'>derivative</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>r</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>nts</span><span class='hljl-p'>)</span><span class='hljl-t'>

</span><span class='hljl-nf'>arrows!</span><span class='hljl-p'>(</span><span class='hljl-n'>scene</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>Point3</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>us</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-n'>Point3</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>dus</span><span class='hljl-p'>))</span>
</pre>



<h5>Attributes</h5>
<p>Attributes for <code>arrows</code> include</p>
<ul>
<li><p><code>arrowsize</code> to adjust the size</p>
</li>
<li><p><code>lengthscale</code> to scale the size</p>
</li>
<li><p><code>arrowcolor</code> to set the color</p>
</li>
<li><p><code>arrowhead</code> to adjust the head</p>
</li>
<li><p><code>arrowtail</code> to adjust the tail</p>
</li>
</ul>
<h3>Implicit equations &#40;2D&#41;</h3>
<p>The graph of an equation is the collection of all <span class="math">$(x,y)$</span> values satisfying the equation. This is more general than the graph of a function, which can be viewed as the graph of the equation <span class="math">$y=f(x)$</span>. An equation in <span class="math">$x$</span>-<span class="math">$y$</span> can be graphed if the set of solutions to a related equation <span class="math">$f(x,y)=0$</span> can be identified, as one can move all terms to one side of an equation and define <span class="math">$f$</span> as the rule of the side with the terms.</p>
<p>The <a href="https://github.com/bachrathyd/MDBM.jl">MDBM</a> &#40;Multi-Dimensional Bisection Method&#41; package can be used for the task of characterizing when <span class="math">$f(x,y)=0$</span>. &#40;Also <code>IntervalConstraintProgramming</code> can be used.&#41; We first wrap its interface and then define a &quot;<code>plot</code>&quot; recipe &#40;through method overloading, not through <code>MakieRecipes</code>&#41;.</p>


<pre class='hljl'>
<span class='hljl-k'>using</span><span class='hljl-t'> </span><span class='hljl-n'>MDBM</span>
</pre>




<pre class='hljl'>
<span class='hljl-k'>function</span><span class='hljl-t'> </span><span class='hljl-nf'>implicit_equation</span><span class='hljl-p'>(</span><span class='hljl-n'>f</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>axes</span><span class='hljl-oB'>...</span><span class='hljl-p'>;</span><span class='hljl-t'> </span><span class='hljl-n'>iteration</span><span class='hljl-oB'>::</span><span class='hljl-n'>Int</span><span class='hljl-oB'>=</span><span class='hljl-ni'>4</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>constraint</span><span class='hljl-oB'>=</span><span class='hljl-n'>nothing</span><span class='hljl-p'>)</span><span class='hljl-t'>

    </span><span class='hljl-n'>axes</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>[</span><span class='hljl-n'>axes</span><span class='hljl-oB'>...</span><span class='hljl-p'>]</span><span class='hljl-t'>

    </span><span class='hljl-k'>if</span><span class='hljl-t'> </span><span class='hljl-n'>constraint</span><span class='hljl-t'> </span><span class='hljl-oB'>==</span><span class='hljl-t'> </span><span class='hljl-n'>nothing</span><span class='hljl-t'>
        </span><span class='hljl-n'>prob</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>MDBM_Problem</span><span class='hljl-p'>(</span><span class='hljl-n'>f</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>axes</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-k'>else</span><span class='hljl-t'>
        </span><span class='hljl-n'>prob</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>MDBM_Problem</span><span class='hljl-p'>(</span><span class='hljl-n'>f</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>axes</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>constraint</span><span class='hljl-oB'>=</span><span class='hljl-n'>constraint</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-k'>end</span><span class='hljl-t'>

    </span><span class='hljl-nf'>solve!</span><span class='hljl-p'>(</span><span class='hljl-n'>prob</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>iteration</span><span class='hljl-p'>)</span><span class='hljl-t'>

    </span><span class='hljl-n'>prob</span><span class='hljl-t'>
</span><span class='hljl-k'>end</span>
</pre>


<pre class="output">
implicit_equation &#40;generic function with 1 method&#41;
</pre>


<p>The <code>implicit_equation</code> function is just a simplified wrapper for the <code>MDBM_Problem</code> interface. It creates an object to be plotted in a manner akin to:</p>


<pre class='hljl'>
<span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>,</span><span class='hljl-n'>y</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>x</span><span class='hljl-oB'>^</span><span class='hljl-ni'>3</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-n'>x</span><span class='hljl-oB'>^</span><span class='hljl-ni'>2</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-n'>x</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-n'>x</span><span class='hljl-oB'>*</span><span class='hljl-n'>y</span><span class='hljl-t'>        </span><span class='hljl-cs'># solve x^3 + x^2 + x + 1 = x*y</span><span class='hljl-t'>
</span><span class='hljl-n'>ie</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>implicit_equation</span><span class='hljl-p'>(</span><span class='hljl-n'>f</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-ni'>5</span><span class='hljl-oB'>:</span><span class='hljl-ni'>5</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-ni'>10</span><span class='hljl-oB'>:</span><span class='hljl-ni'>10</span><span class='hljl-p'>)</span>
</pre>


<pre class="output">
MDBM.MDBM_Problem&#123;MDBM.MemF&#123;typeof&#40;Main.##WeaveSandBox#253.f&#41;,MDBM.var&quot;#17#
19&quot;,Float64,Bool,Tuple&#123;Float64,Float64&#125;&#125;,2,1,1,StaticArrays.SArray&#123;Tuple&#123;4&#125;
,StaticArrays.SArray&#123;Tuple&#123;2&#125;,Bool,1,2&#125;,1,4&#125;,StaticArrays.SArray&#123;Tuple&#123;3,4&#125;
,Float64,2,12&#125;,Int64,Float64,Tuple&#123;MDBM.Axis&#123;Float64&#125;,MDBM.Axis&#123;Float64&#125;&#125;&#125;&#40;
MDBM.MemF&#123;typeof&#40;Main.##WeaveSandBox#253.f&#41;,MDBM.var&quot;#17#19&quot;,Float64,Bool,T
uple&#123;Float64,Float64&#125;&#125;&#40;Main.##WeaveSandBox#253.f, MDBM.var&quot;#17#19&quot;&#40;&#41;, MDBM.
MDBMcontainer&#123;Float64,Bool,Tuple&#123;Float64,Float64&#125;&#125;&#91;MDBM.MDBMcontainer&#123;Float
64,Bool,Tuple&#123;Float64,Float64&#125;&#125;&#40;-154.0, true, &#40;-5.0, -10.0&#41;&#41;, MDBM.MDBMcont
ainer&#123;Float64,Bool,Tuple&#123;Float64,Float64&#125;&#125;&#40;-149.0, true, &#40;-5.0, -9.0&#41;&#41;, MDB
M.MDBMcontainer&#123;Float64,Bool,Tuple&#123;Float64,Float64&#125;&#125;&#40;-144.0, true, &#40;-5.0, -
8.0&#41;&#41;, MDBM.MDBMcontainer&#123;Float64,Bool,Tuple&#123;Float64,Float64&#125;&#125;&#40;-139.0, true
, &#40;-5.0, -7.0&#41;&#41;, MDBM.MDBMcontainer&#123;Float64,Bool,Tuple&#123;Float64,Float64&#125;&#125;&#40;-1
34.0, true, &#40;-5.0, -6.0&#41;&#41;, MDBM.MDBMcontainer&#123;Float64,Bool,Tuple&#123;Float64,Fl
oat64&#125;&#125;&#40;-129.0, true, &#40;-5.0, -5.0&#41;&#41;, MDBM.MDBMcontainer&#123;Float64,Bool,Tuple&#123;
Float64,Float64&#125;&#125;&#40;-124.0, true, &#40;-5.0, -4.0&#41;&#41;, MDBM.MDBMcontainer&#123;Float64,B
ool,Tuple&#123;Float64,Float64&#125;&#125;&#40;-119.0, true, &#40;-5.0, -3.0&#41;&#41;, MDBM.MDBMcontainer
&#123;Float64,Bool,Tuple&#123;Float64,Float64&#125;&#125;&#40;-114.0, true, &#40;-5.0, -2.0&#41;&#41;, MDBM.MDB
Mcontainer&#123;Float64,Bool,Tuple&#123;Float64,Float64&#125;&#125;&#40;-109.0, true, &#40;-5.0, -1.0&#41;&#41;
  …  MDBM.MDBMcontainer&#123;Float64,Bool,Tuple&#123;Float64,Float64&#125;&#125;&#40;151.0, true, &#40;
5.0, 1.0&#41;&#41;, MDBM.MDBMcontainer&#123;Float64,Bool,Tuple&#123;Float64,Float64&#125;&#125;&#40;146.0, 
true, &#40;5.0, 2.0&#41;&#41;, MDBM.MDBMcontainer&#123;Float64,Bool,Tuple&#123;Float64,Float64&#125;&#125;&#40;
141.0, true, &#40;5.0, 3.0&#41;&#41;, MDBM.MDBMcontainer&#123;Float64,Bool,Tuple&#123;Float64,Flo
at64&#125;&#125;&#40;136.0, true, &#40;5.0, 4.0&#41;&#41;, MDBM.MDBMcontainer&#123;Float64,Bool,Tuple&#123;Floa
t64,Float64&#125;&#125;&#40;131.0, true, &#40;5.0, 5.0&#41;&#41;, MDBM.MDBMcontainer&#123;Float64,Bool,Tup
le&#123;Float64,Float64&#125;&#125;&#40;126.0, true, &#40;5.0, 6.0&#41;&#41;, MDBM.MDBMcontainer&#123;Float64,B
ool,Tuple&#123;Float64,Float64&#125;&#125;&#40;121.0, true, &#40;5.0, 7.0&#41;&#41;, MDBM.MDBMcontainer&#123;Fl
oat64,Bool,Tuple&#123;Float64,Float64&#125;&#125;&#40;116.0, true, &#40;5.0, 8.0&#41;&#41;, MDBM.MDBMconta
iner&#123;Float64,Bool,Tuple&#123;Float64,Float64&#125;&#125;&#40;111.0, true, &#40;5.0, 9.0&#41;&#41;, MDBM.MD
BMcontainer&#123;Float64,Bool,Tuple&#123;Float64,Float64&#125;&#125;&#40;106.0, true, &#40;5.0, 10.0&#41;&#41;&#93;
, &#91;19012&#93;&#41;, MDBM.Axes&#123;2,Tuple&#123;MDBM.Axis&#123;Float64&#125;,MDBM.Axis&#123;Float64&#125;&#125;&#125;&#40;&#40;&#91;-5.
0, -4.9375, -4.875, -4.8125, -4.75, -4.6875, -4.625, -4.5625, -4.5, -4.4375
  …  4.4375, 4.5, 4.5625, 4.625, 4.6875, 4.75, 4.8125, 4.875, 4.9375, 5.0&#93;,
 &#91;-10.0, -9.9375, -9.875, -9.8125, -9.75, -9.6875, -9.625, -9.5625, -9.5, -
9.4375  …  9.4375, 9.5, 9.5625, 9.625, 9.6875, 9.75, 9.8125, 9.875, 9.9375,
 10.0&#93;&#41;&#41;, MDBM.NCube&#123;Int64,Float64,2&#125;&#91;MDBM.NCube&#123;Int64,Float64,2&#125;&#40;&#91;23, 316&#93;
, &#91;1, 1&#93;, &#91;1.6063732892989169, 0.25275584507525284&#93;, true&#41;, MDBM.NCube&#123;Int6
4,Float64,2&#125;&#40;&#91;23, 317&#93;, &#91;1, 1&#93;, &#91;1.3026770110598742, 0.205532987510733&#93;, tr
ue&#41;, MDBM.NCube&#123;Int64,Float64,2&#125;&#40;&#91;23, 318&#93;, &#91;1, 1&#93;, &#91;0.9973904105883838, 0.
15779865481363942&#93;, true&#41;, MDBM.NCube&#123;Int64,Float64,2&#125;&#40;&#91;23, 319&#93;, &#91;1, 1&#93;, &#91;
0.6905013026761199, 0.10954668019693573&#93;, true&#41;, MDBM.NCube&#123;Int64,Float64,2
&#125;&#40;&#91;23, 320&#93;, &#91;1, 1&#93;, &#91;0.3819973811799878, 0.06077080938709818&#93;, true&#41;, MDBM
.NCube&#123;Int64,Float64,2&#125;&#40;&#91;24, 310&#93;, &#91;1, 1&#93;, &#91;1.5730148223057674, 0.252441931
36240256&#93;, true&#41;, MDBM.NCube&#123;Int64,Float64,2&#125;&#40;&#91;24, 311&#93;, &#91;1, 1&#93;, &#91;1.2635163
443540753, 0.2033503249592459&#93;, true&#41;, MDBM.NCube&#123;Int64,Float64,2&#125;&#40;&#91;24, 312
&#93;, &#91;1, 1&#93;, &#91;0.9523386316264015, 0.15370721710235083&#93;, true&#41;, MDBM.NCube&#123;Int
64,Float64,2&#125;&#40;&#91;24, 313&#93;, &#91;1, 1&#93;, &#91;0.6394683680980245, 0.1035057125802353&#93;, 
true&#41;, MDBM.NCube&#123;Int64,Float64,2&#125;&#40;&#91;24, 314&#93;, &#91;1, 1&#93;, &#91;0.324892101175531, 0
.05273881477153529&#93;, true&#41;  …  MDBM.NCube&#123;Int64,Float64,2&#125;&#40;&#91;119, 316&#93;, &#91;1, 
1&#93;, &#91;0.5737847603815756, -0.10253884896868308&#93;, true&#41;, MDBM.NCube&#123;Int64,Flo
at64,2&#125;&#40;&#91;119, 317&#93;, &#91;1, 1&#93;, &#91;0.9241595306873377, -0.16592313346062373&#93;, tru
e&#41;, MDBM.NCube&#123;Int64,Float64,2&#125;&#40;&#91;119, 318&#93;, &#91;1, 1&#93;, &#91;1.2776102439518204, -0
.23045619627359337&#93;, true&#41;, MDBM.NCube&#123;Int64,Float64,2&#125;&#40;&#91;119, 319&#93;, &#91;1, 1&#93;,
 &#91;1.6341761101488126, -0.2961613662405615&#93;, true&#41;, MDBM.NCube&#123;Int64,Float64
,2&#125;&#40;&#91;120, 315&#93;, &#91;1, 1&#93;, &#91;-1.6639239167933426, 0.28200587702155877&#93;, true&#41;, 
MDBM.NCube&#123;Int64,Float64,2&#125;&#40;&#91;120, 316&#93;, &#91;1, 1&#93;, &#91;-1.3398508634660045, 0.228
05972144102202&#93;, true&#41;, MDBM.NCube&#123;Int64,Float64,2&#125;&#40;&#91;120, 317&#93;, &#91;1, 1&#93;, &#91;-1
.013129945313339, 0.17319397496295114&#93;, true&#41;, MDBM.NCube&#123;Int64,Float64,2&#125;&#40;
&#91;120, 318&#93;, &#91;1, 1&#93;, &#91;-0.6837296229134533, 0.11739123110059835&#93;, true&#41;, MDBM
.NCube&#123;Int64,Float64,2&#125;&#40;&#91;120, 319&#93;, &#91;1, 1&#93;, &#91;-0.35161787289425867, 0.060633
695953389216&#93;, true&#41;, MDBM.NCube&#123;Int64,Float64,2&#125;&#40;&#91;120, 320&#93;, &#91;1, 1&#93;, &#91;-0.0
1676217906067428, 0.002903178176581569&#93;, true&#41;&#93;, StaticArrays.SArray&#123;Tuple&#123;
2&#125;,Bool,1,2&#125;&#91;&#91;0, 0&#93;, &#91;1, 0&#93;, &#91;0, 1&#93;, &#91;1, 1&#93;&#93;, &#91;-0.25 0.25 -0.25 0.25; -0.25
 -0.25 0.25 0.25; -0.25 -0.25 -0.25 -0.25&#93;&#41;
</pre>


<p>The function definition is straightforward. The limits for <code>x</code> and <code>y</code> are specified in the above using ranges. This specifies the initial grid of points for the apdaptive algorithm used by <code>MDBM</code> to identify solutions.</p>
<p>To visualize the output, we make a new method for <code>plot</code> and <code>plot&#33;</code>. There is a distinction between 2 and 3 dimensions. Below in two dimensions curve&#40;s&#41; are drawn. In three dimensions, scaled cubes are used to indicate the surface.</p>


<pre class='hljl'>
<span class='hljl-n'>AbstractPlotting</span><span class='hljl-oB'>.</span><span class='hljl-nf'>plot</span><span class='hljl-p'>(</span><span class='hljl-n'>m</span><span class='hljl-oB'>::</span><span class='hljl-n'>MDBM_Problem</span><span class='hljl-p'>;</span><span class='hljl-t'> </span><span class='hljl-n'>kwargs</span><span class='hljl-oB'>...</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>plot!</span><span class='hljl-p'>(</span><span class='hljl-nf'>Scene</span><span class='hljl-p'>(),</span><span class='hljl-t'> </span><span class='hljl-n'>m</span><span class='hljl-p'>;</span><span class='hljl-t'> </span><span class='hljl-n'>kwargs</span><span class='hljl-oB'>...</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>AbstractPlotting</span><span class='hljl-oB'>.</span><span class='hljl-nf'>plot!</span><span class='hljl-p'>(</span><span class='hljl-n'>m</span><span class='hljl-oB'>::</span><span class='hljl-n'>MDBM_Problem</span><span class='hljl-p'>;</span><span class='hljl-t'> </span><span class='hljl-n'>kwargs</span><span class='hljl-oB'>...</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>plot!</span><span class='hljl-p'>(</span><span class='hljl-n'>AbstractPlotting</span><span class='hljl-oB'>.</span><span class='hljl-nf'>current_scene</span><span class='hljl-p'>(),</span><span class='hljl-t'> </span><span class='hljl-n'>m</span><span class='hljl-p'>;</span><span class='hljl-t'> </span><span class='hljl-n'>kwargs</span><span class='hljl-oB'>...</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>AbstractPlotting</span><span class='hljl-oB'>.</span><span class='hljl-nf'>plot!</span><span class='hljl-p'>(</span><span class='hljl-n'>scene</span><span class='hljl-oB'>::</span><span class='hljl-n'>AbstractPlotting</span><span class='hljl-oB'>.</span><span class='hljl-n'>Scene</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>m</span><span class='hljl-oB'>::</span><span class='hljl-n'>MDBM_Problem</span><span class='hljl-p'>;</span><span class='hljl-t'> </span><span class='hljl-n'>kwargs</span><span class='hljl-oB'>...</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'>
    </span><span class='hljl-nf'>plot!</span><span class='hljl-p'>(</span><span class='hljl-nf'>Val</span><span class='hljl-p'>(</span><span class='hljl-nf'>_dim</span><span class='hljl-p'>(</span><span class='hljl-n'>m</span><span class='hljl-p'>)),</span><span class='hljl-t'> </span><span class='hljl-n'>scene</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>m</span><span class='hljl-p'>;</span><span class='hljl-t'> </span><span class='hljl-n'>kwargs</span><span class='hljl-oB'>...</span><span class='hljl-p'>)</span><span class='hljl-t'>

</span><span class='hljl-nf'>_dim</span><span class='hljl-p'>(</span><span class='hljl-n'>m</span><span class='hljl-oB'>::</span><span class='hljl-n'>MDBM</span><span class='hljl-oB'>.</span><span class='hljl-nf'>MDBM_Problem</span><span class='hljl-p'>{</span><span class='hljl-n'>a</span><span class='hljl-p'>,</span><span class='hljl-n'>N</span><span class='hljl-p'>,</span><span class='hljl-n'>b</span><span class='hljl-p'>,</span><span class='hljl-n'>c</span><span class='hljl-p'>,</span><span class='hljl-n'>d</span><span class='hljl-p'>,</span><span class='hljl-n'>e</span><span class='hljl-p'>,</span><span class='hljl-n'>f</span><span class='hljl-p'>,</span><span class='hljl-n'>g</span><span class='hljl-p'>,</span><span class='hljl-n'>h</span><span class='hljl-p'>})</span><span class='hljl-t'> </span><span class='hljl-n'>where</span><span class='hljl-t'> </span><span class='hljl-p'>{</span><span class='hljl-n'>a</span><span class='hljl-p'>,</span><span class='hljl-n'>N</span><span class='hljl-p'>,</span><span class='hljl-n'>b</span><span class='hljl-p'>,</span><span class='hljl-n'>c</span><span class='hljl-p'>,</span><span class='hljl-n'>d</span><span class='hljl-p'>,</span><span class='hljl-n'>e</span><span class='hljl-p'>,</span><span class='hljl-n'>f</span><span class='hljl-p'>,</span><span class='hljl-n'>g</span><span class='hljl-p'>,</span><span class='hljl-n'>h</span><span class='hljl-p'>}</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>N</span>
</pre>


<pre class="output">
_dim &#40;generic function with 1 method&#41;
</pre>


<p>Dispatch is used for the two different dimesions, identified through <code>_dim</code>, defined above.</p>


<pre class='hljl'>
<span class='hljl-cs'># 2D plot</span><span class='hljl-t'>
</span><span class='hljl-k'>function</span><span class='hljl-t'> </span><span class='hljl-n'>AbstractPlotting</span><span class='hljl-oB'>.</span><span class='hljl-nf'>plot!</span><span class='hljl-p'>(</span><span class='hljl-oB'>::</span><span class='hljl-nf'>Val</span><span class='hljl-p'>{</span><span class='hljl-ni'>2</span><span class='hljl-p'>},</span><span class='hljl-t'> </span><span class='hljl-n'>scene</span><span class='hljl-oB'>::</span><span class='hljl-n'>AbstractPlotting</span><span class='hljl-oB'>.</span><span class='hljl-n'>Scene</span><span class='hljl-p'>,</span><span class='hljl-t'>
    </span><span class='hljl-n'>m</span><span class='hljl-oB'>::</span><span class='hljl-n'>MDBM_Problem</span><span class='hljl-p'>;</span><span class='hljl-t'> </span><span class='hljl-n'>color</span><span class='hljl-oB'>=:</span><span class='hljl-n'>black</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>kwargs</span><span class='hljl-oB'>...</span><span class='hljl-p'>)</span><span class='hljl-t'>

    </span><span class='hljl-n'>mdt</span><span class='hljl-oB'>=</span><span class='hljl-n'>MDBM</span><span class='hljl-oB'>.</span><span class='hljl-nf'>connect</span><span class='hljl-p'>(</span><span class='hljl-n'>m</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-k'>for</span><span class='hljl-t'> </span><span class='hljl-n'>i</span><span class='hljl-t'> </span><span class='hljl-kp'>in</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-oB'>:</span><span class='hljl-nf'>length</span><span class='hljl-p'>(</span><span class='hljl-n'>mdt</span><span class='hljl-p'>)</span><span class='hljl-t'>
        </span><span class='hljl-n'>dt</span><span class='hljl-oB'>=</span><span class='hljl-n'>mdt</span><span class='hljl-p'>[</span><span class='hljl-n'>i</span><span class='hljl-p'>]</span><span class='hljl-t'>
        </span><span class='hljl-n'>P1</span><span class='hljl-oB'>=</span><span class='hljl-nf'>getinterpolatedsolution</span><span class='hljl-p'>(</span><span class='hljl-n'>m</span><span class='hljl-oB'>.</span><span class='hljl-n'>ncubes</span><span class='hljl-p'>[</span><span class='hljl-n'>dt</span><span class='hljl-p'>[</span><span class='hljl-ni'>1</span><span class='hljl-p'>]],</span><span class='hljl-t'> </span><span class='hljl-n'>m</span><span class='hljl-p'>)</span><span class='hljl-t'>
        </span><span class='hljl-n'>P2</span><span class='hljl-oB'>=</span><span class='hljl-nf'>getinterpolatedsolution</span><span class='hljl-p'>(</span><span class='hljl-n'>m</span><span class='hljl-oB'>.</span><span class='hljl-n'>ncubes</span><span class='hljl-p'>[</span><span class='hljl-n'>dt</span><span class='hljl-p'>[</span><span class='hljl-ni'>2</span><span class='hljl-p'>]],</span><span class='hljl-t'> </span><span class='hljl-n'>m</span><span class='hljl-p'>)</span><span class='hljl-t'>
        </span><span class='hljl-nf'>lines!</span><span class='hljl-p'>(</span><span class='hljl-n'>scene</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-p'>[</span><span class='hljl-n'>P1</span><span class='hljl-p'>[</span><span class='hljl-ni'>1</span><span class='hljl-p'>],</span><span class='hljl-n'>P2</span><span class='hljl-p'>[</span><span class='hljl-ni'>1</span><span class='hljl-p'>]],[</span><span class='hljl-n'>P1</span><span class='hljl-p'>[</span><span class='hljl-ni'>2</span><span class='hljl-p'>],</span><span class='hljl-n'>P2</span><span class='hljl-p'>[</span><span class='hljl-ni'>2</span><span class='hljl-p'>]],</span><span class='hljl-t'> </span><span class='hljl-n'>color</span><span class='hljl-oB'>=</span><span class='hljl-n'>color</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>kwargs</span><span class='hljl-oB'>...</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-k'>end</span><span class='hljl-t'>

    </span><span class='hljl-n'>scene</span><span class='hljl-t'>
</span><span class='hljl-k'>end</span>
</pre>




<pre class='hljl'>
<span class='hljl-cs'># 3D plot</span><span class='hljl-t'>
</span><span class='hljl-k'>function</span><span class='hljl-t'> </span><span class='hljl-n'>AbstractPlotting</span><span class='hljl-oB'>.</span><span class='hljl-nf'>plot!</span><span class='hljl-p'>(</span><span class='hljl-oB'>::</span><span class='hljl-nf'>Val</span><span class='hljl-p'>{</span><span class='hljl-ni'>3</span><span class='hljl-p'>},</span><span class='hljl-t'> </span><span class='hljl-n'>scene</span><span class='hljl-oB'>::</span><span class='hljl-n'>AbstractPlotting</span><span class='hljl-oB'>.</span><span class='hljl-n'>Scene</span><span class='hljl-p'>,</span><span class='hljl-t'>
    </span><span class='hljl-n'>m</span><span class='hljl-oB'>::</span><span class='hljl-n'>MDBM_Problem</span><span class='hljl-p'>;</span><span class='hljl-t'> </span><span class='hljl-n'>color</span><span class='hljl-oB'>=:</span><span class='hljl-n'>black</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>kwargs</span><span class='hljl-oB'>...</span><span class='hljl-p'>)</span><span class='hljl-t'>

    </span><span class='hljl-n'>positions</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>Point</span><span class='hljl-p'>{</span><span class='hljl-ni'>3</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>Float32</span><span class='hljl-p'>}[]</span><span class='hljl-t'>
    </span><span class='hljl-n'>scales</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>Vec3</span><span class='hljl-p'>[]</span><span class='hljl-t'>
    
    </span><span class='hljl-n'>mdt</span><span class='hljl-oB'>=</span><span class='hljl-n'>MDBM</span><span class='hljl-oB'>.</span><span class='hljl-nf'>connect</span><span class='hljl-p'>(</span><span class='hljl-n'>m</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-k'>for</span><span class='hljl-t'> </span><span class='hljl-n'>i</span><span class='hljl-t'> </span><span class='hljl-kp'>in</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-oB'>:</span><span class='hljl-nf'>length</span><span class='hljl-p'>(</span><span class='hljl-n'>mdt</span><span class='hljl-p'>)</span><span class='hljl-t'>
        </span><span class='hljl-n'>dt</span><span class='hljl-oB'>=</span><span class='hljl-n'>mdt</span><span class='hljl-p'>[</span><span class='hljl-n'>i</span><span class='hljl-p'>]</span><span class='hljl-t'>
        </span><span class='hljl-n'>P1</span><span class='hljl-oB'>=</span><span class='hljl-nf'>getinterpolatedsolution</span><span class='hljl-p'>(</span><span class='hljl-n'>m</span><span class='hljl-oB'>.</span><span class='hljl-n'>ncubes</span><span class='hljl-p'>[</span><span class='hljl-n'>dt</span><span class='hljl-p'>[</span><span class='hljl-ni'>1</span><span class='hljl-p'>]],</span><span class='hljl-t'> </span><span class='hljl-n'>m</span><span class='hljl-p'>)</span><span class='hljl-t'>
        </span><span class='hljl-n'>P2</span><span class='hljl-oB'>=</span><span class='hljl-nf'>getinterpolatedsolution</span><span class='hljl-p'>(</span><span class='hljl-n'>m</span><span class='hljl-oB'>.</span><span class='hljl-n'>ncubes</span><span class='hljl-p'>[</span><span class='hljl-n'>dt</span><span class='hljl-p'>[</span><span class='hljl-ni'>2</span><span class='hljl-p'>]],</span><span class='hljl-t'> </span><span class='hljl-n'>m</span><span class='hljl-p'>)</span><span class='hljl-t'>

        </span><span class='hljl-n'>a</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>b</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>Vec3</span><span class='hljl-p'>(</span><span class='hljl-n'>P1</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-nf'>Vec3</span><span class='hljl-p'>(</span><span class='hljl-n'>P2</span><span class='hljl-p'>)</span><span class='hljl-t'>
        </span><span class='hljl-nf'>push!</span><span class='hljl-p'>(</span><span class='hljl-n'>positions</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-nf'>Point3</span><span class='hljl-p'>(</span><span class='hljl-n'>P1</span><span class='hljl-p'>))</span><span class='hljl-t'>
        </span><span class='hljl-nf'>push!</span><span class='hljl-p'>(</span><span class='hljl-n'>scales</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>b</span><span class='hljl-oB'>-</span><span class='hljl-n'>a</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-k'>end</span><span class='hljl-t'>

    </span><span class='hljl-n'>cube</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>Rect</span><span class='hljl-p'>{</span><span class='hljl-ni'>3</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>Float32</span><span class='hljl-p'>}(</span><span class='hljl-nf'>Vec3</span><span class='hljl-p'>(</span><span class='hljl-oB'>-</span><span class='hljl-nfB'>0.5</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-nfB'>0.5</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-nfB'>0.5</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-nf'>Vec3</span><span class='hljl-p'>(</span><span class='hljl-ni'>1</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-p'>))</span><span class='hljl-t'>
    </span><span class='hljl-nf'>meshscatter!</span><span class='hljl-p'>(</span><span class='hljl-n'>scene</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>positions</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>marker</span><span class='hljl-oB'>=</span><span class='hljl-n'>cube</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>scale</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>scales</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>color</span><span class='hljl-oB'>=</span><span class='hljl-n'>color</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>transparency</span><span class='hljl-oB'>=</span><span class='hljl-kc'>true</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>kwargs</span><span class='hljl-oB'>...</span><span class='hljl-p'>)</span><span class='hljl-t'>
    
    </span><span class='hljl-n'>scene</span><span class='hljl-t'>
</span><span class='hljl-k'>end</span>
</pre>



<p>We see that the equation <code>ie</code> has two pieces. &#40;This is known as Newton&#39;s trident, as Newton was interested in this form of equation.&#41;</p>


<pre class='hljl'>
<span class='hljl-nf'>plot</span><span class='hljl-p'>(</span><span class='hljl-n'>ie</span><span class='hljl-p'>)</span>
</pre>



<h2>Surfaces</h2>
<p>Plots of surfaces in 3 dimensions are useful to help understand the behavior of multivariate functions.</p>
<h4>Surfaces defined through <span class="math">$z=f(x,y)$</span></h4>
<p>The &quot;peaks&quot; function generates the logo for MATLAB. Here we see how it can be plotted over the region <span class="math">$[-5,5]\times[-5,5]$</span>.</p>


<pre class='hljl'>
<span class='hljl-nf'>peaks</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>,</span><span class='hljl-n'>y</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-ni'>3</span><span class='hljl-oB'>*</span><span class='hljl-p'>(</span><span class='hljl-ni'>1</span><span class='hljl-oB'>-</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-oB'>^</span><span class='hljl-ni'>2</span><span class='hljl-oB'>*</span><span class='hljl-nf'>exp</span><span class='hljl-p'>(</span><span class='hljl-oB'>-</span><span class='hljl-n'>x</span><span class='hljl-oB'>^</span><span class='hljl-ni'>2</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-n'>y</span><span class='hljl-oB'>+</span><span class='hljl-ni'>1</span><span class='hljl-p'>)</span><span class='hljl-oB'>^</span><span class='hljl-ni'>2</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-ni'>10</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-oB'>/</span><span class='hljl-ni'>5</span><span class='hljl-oB'>-</span><span class='hljl-n'>x</span><span class='hljl-oB'>^</span><span class='hljl-ni'>3</span><span class='hljl-oB'>-</span><span class='hljl-n'>y</span><span class='hljl-oB'>^</span><span class='hljl-ni'>5</span><span class='hljl-p'>)</span><span class='hljl-oB'>*</span><span class='hljl-nf'>exp</span><span class='hljl-p'>(</span><span class='hljl-oB'>-</span><span class='hljl-n'>x</span><span class='hljl-oB'>^</span><span class='hljl-ni'>2</span><span class='hljl-oB'>-</span><span class='hljl-n'>y</span><span class='hljl-oB'>^</span><span class='hljl-ni'>2</span><span class='hljl-p'>)</span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-oB'>/</span><span class='hljl-ni'>3</span><span class='hljl-oB'>*</span><span class='hljl-nf'>exp</span><span class='hljl-p'>(</span><span class='hljl-oB'>-</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-oB'>+</span><span class='hljl-ni'>1</span><span class='hljl-p'>)</span><span class='hljl-oB'>^</span><span class='hljl-ni'>2</span><span class='hljl-oB'>-</span><span class='hljl-n'>y</span><span class='hljl-oB'>^</span><span class='hljl-ni'>2</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>xs</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>ys</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>range</span><span class='hljl-p'>(</span><span class='hljl-oB'>-</span><span class='hljl-ni'>5</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>5</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>length</span><span class='hljl-oB'>=</span><span class='hljl-ni'>25</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>surface</span><span class='hljl-p'>(</span><span class='hljl-n'>xs</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>ys</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>peaks</span><span class='hljl-p'>)</span>
</pre>



<p>The calling pattern <code>surface&#40;xs, ys, f&#41;</code> implies a rectangular grid over the <span class="math">$x$</span>-<span class="math">$y$</span> plane defined by <code>xs</code> and <code>ys</code> with <span class="math">$z$</span> values given by <span class="math">$f(x,y)$</span>. </p>
<p>Alternatively a &quot;matrix&quot; of <span class="math">$z$</span> values can be specified. For a function <code>f</code>, this is conveniently generated by the pattern <code>f.&#40;xs, ys&#39;&#41;</code>, the <code>&#39;</code> being important to get a matrix of all <span class="math">$x$</span>-<span class="math">$y$</span> pairs through <code>Julia</code>&#39;s broadcasting syntax.</p>


<pre class='hljl'>
<span class='hljl-n'>zs</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>peaks</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>xs</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>ys</span><span class='hljl-oB'>&#39;</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>surface</span><span class='hljl-p'>(</span><span class='hljl-n'>xs</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>ys</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>zs</span><span class='hljl-p'>)</span>
</pre>



<p>To see how this graph is constructed, the points <span class="math">$(x,y,f(x,y))$</span> are plotted over the grid and displayed. </p>
<p>Here we downsample to illutrate</p>


<pre class='hljl'>
<span class='hljl-n'>xs</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>ys</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>range</span><span class='hljl-p'>(</span><span class='hljl-oB'>-</span><span class='hljl-ni'>5</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>5</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>length</span><span class='hljl-oB'>=</span><span class='hljl-ni'>5</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>pts</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>[</span><span class='hljl-nf'>Point3</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>y</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-nf'>peaks</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>,</span><span class='hljl-n'>y</span><span class='hljl-p'>))</span><span class='hljl-t'> </span><span class='hljl-k'>for</span><span class='hljl-t'> </span><span class='hljl-n'>x</span><span class='hljl-t'> </span><span class='hljl-kp'>in</span><span class='hljl-t'> </span><span class='hljl-n'>xs</span><span class='hljl-t'> </span><span class='hljl-k'>for</span><span class='hljl-t'> </span><span class='hljl-n'>y</span><span class='hljl-t'> </span><span class='hljl-kp'>in</span><span class='hljl-t'> </span><span class='hljl-n'>ys</span><span class='hljl-p'>]</span><span class='hljl-t'>
</span><span class='hljl-nf'>scatter</span><span class='hljl-p'>(</span><span class='hljl-n'>pts</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>markersize</span><span class='hljl-oB'>=</span><span class='hljl-ni'>25</span><span class='hljl-p'>)</span>
</pre>



<p>These points are connected. The <code>wireframe</code> function illustrates just the frame</p>


<pre class='hljl'>
<span class='hljl-nf'>wireframe</span><span class='hljl-p'>(</span><span class='hljl-n'>xs</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>ys</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>peaks</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>xs</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>ys</span><span class='hljl-oB'>&#39;</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-n'>linewidth</span><span class='hljl-oB'>=</span><span class='hljl-ni'>5</span><span class='hljl-p'>)</span>
</pre>



<p>The <code>surface</code> call triangulates the frame and fills in the shading:</p>


<pre class='hljl'>
<span class='hljl-nf'>surface!</span><span class='hljl-p'>(</span><span class='hljl-n'>xs</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>ys</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>peaks</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>xs</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>ys</span><span class='hljl-oB'>&#39;</span><span class='hljl-p'>))</span>
</pre>



<h4>Implicitly defined surfaces, <span class="math">$F(x,y,z)=0$</span></h4>
<p>The set of points <span class="math">$(x,y,z)$</span> satisfying <span class="math">$F(x,y,z) = 0$</span> will form a surface that can be visualized using the <code>MDBM</code> package. We illustrate showing two nested surfaces.</p>


<pre class='hljl'>
<span class='hljl-nf'>r₂</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>,</span><span class='hljl-n'>y</span><span class='hljl-p'>,</span><span class='hljl-n'>z</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>x</span><span class='hljl-oB'>^</span><span class='hljl-ni'>2</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-n'>y</span><span class='hljl-oB'>^</span><span class='hljl-ni'>2</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-n'>z</span><span class='hljl-oB'>^</span><span class='hljl-ni'>2</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-ni'>5</span><span class='hljl-oB'>/</span><span class='hljl-ni'>4</span><span class='hljl-t'> </span><span class='hljl-cs'># a sphere</span><span class='hljl-t'>
</span><span class='hljl-nf'>r₄</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>,</span><span class='hljl-n'>y</span><span class='hljl-p'>,</span><span class='hljl-n'>z</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>x</span><span class='hljl-oB'>^</span><span class='hljl-ni'>4</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-n'>y</span><span class='hljl-oB'>^</span><span class='hljl-ni'>4</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-n'>z</span><span class='hljl-oB'>^</span><span class='hljl-ni'>4</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-t'>
</span><span class='hljl-n'>xs</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>ys</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>zs</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-ni'>2</span><span class='hljl-oB'>:</span><span class='hljl-ni'>2</span><span class='hljl-t'>
</span><span class='hljl-n'>m2</span><span class='hljl-p'>,</span><span class='hljl-n'>m4</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>implicit_equation</span><span class='hljl-p'>(</span><span class='hljl-n'>r₂</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>xs</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>ys</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>zs</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-nf'>implicit_equation</span><span class='hljl-p'>(</span><span class='hljl-n'>r₄</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>xs</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>ys</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>zs</span><span class='hljl-p'>)</span><span class='hljl-t'>

</span><span class='hljl-nf'>plot</span><span class='hljl-p'>(</span><span class='hljl-n'>m4</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>color</span><span class='hljl-oB'>=:</span><span class='hljl-n'>yellow</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>plot!</span><span class='hljl-p'>(</span><span class='hljl-n'>m2</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>color</span><span class='hljl-oB'>=:</span><span class='hljl-n'>red</span><span class='hljl-p'>)</span>
</pre>



<h4>Parametrically defined surfaces</h4>
<p>A surface may be parametrically defined through a function <span class="math">$r(u,v) = (x(u,v), y(u,v), z(u,v))$</span>. For example, the surface generated by <span class="math">$z=f(x,y)$</span> is of the form with <span class="math">$r(u,v) = (u,v,f(u,v))$</span>. </p>
<p>The <code>surface</code> function and the <code>wireframe</code> function can be used to display such surfaces. In previous usages, the <code>x</code> and <code>y</code> values were vectors from which a 2-dimensional grid is formed. For parametric surfaces, a grid for the <code>x</code> and <code>y</code> values must be generated. This function will do so:</p>


<pre class='hljl'>
<span class='hljl-k'>function</span><span class='hljl-t'> </span><span class='hljl-nf'>parametric_grid</span><span class='hljl-p'>(</span><span class='hljl-n'>us</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>vs</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>r</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-n'>n</span><span class='hljl-p'>,</span><span class='hljl-n'>m</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>length</span><span class='hljl-p'>(</span><span class='hljl-n'>us</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-nf'>length</span><span class='hljl-p'>(</span><span class='hljl-n'>vs</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-n'>xs</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>ys</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>zs</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>zeros</span><span class='hljl-p'>(</span><span class='hljl-n'>n</span><span class='hljl-p'>,</span><span class='hljl-n'>m</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-nf'>zeros</span><span class='hljl-p'>(</span><span class='hljl-n'>n</span><span class='hljl-p'>,</span><span class='hljl-n'>m</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-nf'>zeros</span><span class='hljl-p'>(</span><span class='hljl-n'>n</span><span class='hljl-p'>,</span><span class='hljl-n'>m</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-k'>for</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-n'>i</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>uᵢ</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-kp'>in</span><span class='hljl-t'> </span><span class='hljl-nf'>enumerate</span><span class='hljl-p'>(</span><span class='hljl-n'>us</span><span class='hljl-p'>)</span><span class='hljl-t'>
        </span><span class='hljl-k'>for</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-n'>j</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>vⱼ</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-kp'>in</span><span class='hljl-t'> </span><span class='hljl-nf'>enumerate</span><span class='hljl-p'>(</span><span class='hljl-n'>vs</span><span class='hljl-p'>)</span><span class='hljl-t'>
            </span><span class='hljl-n'>x</span><span class='hljl-p'>,</span><span class='hljl-n'>y</span><span class='hljl-p'>,</span><span class='hljl-n'>z</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>r</span><span class='hljl-p'>(</span><span class='hljl-n'>uᵢ</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>vⱼ</span><span class='hljl-p'>)</span><span class='hljl-t'>
            </span><span class='hljl-n'>xs</span><span class='hljl-p'>[</span><span class='hljl-n'>i</span><span class='hljl-p'>,</span><span class='hljl-n'>j</span><span class='hljl-p'>]</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>x</span><span class='hljl-t'>
            </span><span class='hljl-n'>ys</span><span class='hljl-p'>[</span><span class='hljl-n'>i</span><span class='hljl-p'>,</span><span class='hljl-n'>j</span><span class='hljl-p'>]</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>y</span><span class='hljl-t'>
            </span><span class='hljl-n'>zs</span><span class='hljl-p'>[</span><span class='hljl-n'>i</span><span class='hljl-p'>,</span><span class='hljl-n'>j</span><span class='hljl-p'>]</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>z</span><span class='hljl-t'>
        </span><span class='hljl-k'>end</span><span class='hljl-t'>
    </span><span class='hljl-k'>end</span><span class='hljl-t'>
    </span><span class='hljl-p'>(</span><span class='hljl-n'>xs</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>ys</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>zs</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-k'>end</span>
</pre>


<pre class="output">
parametric_grid &#40;generic function with 1 method&#41;
</pre>


<p>With the data suitably massaged, we can directly plot either a <code>surface</code> or <code>wireframe</code> plot.</p>
<p>For example, a sphere can be parameterized by <span class="math">$r(u,v) = (\sin(u)\cos(v), \sin(u)\sin(v), \cos(u))$</span> and visualized through:</p>


<pre class='hljl'>
<span class='hljl-nf'>r</span><span class='hljl-p'>(</span><span class='hljl-n'>u</span><span class='hljl-p'>,</span><span class='hljl-n'>v</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>[</span><span class='hljl-nf'>sin</span><span class='hljl-p'>(</span><span class='hljl-n'>u</span><span class='hljl-p'>)</span><span class='hljl-oB'>*</span><span class='hljl-nf'>cos</span><span class='hljl-p'>(</span><span class='hljl-n'>v</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-nf'>sin</span><span class='hljl-p'>(</span><span class='hljl-n'>u</span><span class='hljl-p'>)</span><span class='hljl-oB'>*</span><span class='hljl-nf'>sin</span><span class='hljl-p'>(</span><span class='hljl-n'>v</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-nf'>cos</span><span class='hljl-p'>(</span><span class='hljl-n'>u</span><span class='hljl-p'>)]</span><span class='hljl-t'>
</span><span class='hljl-n'>us</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>range</span><span class='hljl-p'>(</span><span class='hljl-ni'>0</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>pi</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>length</span><span class='hljl-oB'>=</span><span class='hljl-ni'>25</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>vs</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>range</span><span class='hljl-p'>(</span><span class='hljl-ni'>0</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>pi</span><span class='hljl-oB'>/</span><span class='hljl-ni'>2</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>length</span><span class='hljl-oB'>=</span><span class='hljl-ni'>25</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>xs</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>ys</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>zs</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>parametric_grid</span><span class='hljl-p'>(</span><span class='hljl-n'>us</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>vs</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>r</span><span class='hljl-p'>)</span><span class='hljl-t'>

</span><span class='hljl-n'>scene</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>Scene</span><span class='hljl-p'>()</span><span class='hljl-t'>
</span><span class='hljl-nf'>surface!</span><span class='hljl-p'>(</span><span class='hljl-n'>scene</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>xs</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>ys</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>zs</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>wireframe!</span><span class='hljl-p'>(</span><span class='hljl-n'>scene</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>xs</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>ys</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>zs</span><span class='hljl-p'>)</span>
</pre>



<p>A surface of revolution for <span class="math">$g(u)$</span> revolved about the <span class="math">$z$</span> axis can be visualized through:</p>


<pre class='hljl'>
<span class='hljl-nf'>g</span><span class='hljl-p'>(</span><span class='hljl-n'>u</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>u</span><span class='hljl-oB'>^</span><span class='hljl-ni'>2</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-nf'>exp</span><span class='hljl-p'>(</span><span class='hljl-oB'>-</span><span class='hljl-n'>u</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>r</span><span class='hljl-p'>(</span><span class='hljl-n'>u</span><span class='hljl-p'>,</span><span class='hljl-n'>v</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-nf'>g</span><span class='hljl-p'>(</span><span class='hljl-n'>u</span><span class='hljl-p'>)</span><span class='hljl-oB'>*</span><span class='hljl-nf'>sin</span><span class='hljl-p'>(</span><span class='hljl-n'>v</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-nf'>g</span><span class='hljl-p'>(</span><span class='hljl-n'>u</span><span class='hljl-p'>)</span><span class='hljl-oB'>*</span><span class='hljl-nf'>cos</span><span class='hljl-p'>(</span><span class='hljl-n'>v</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-n'>u</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>us</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>range</span><span class='hljl-p'>(</span><span class='hljl-ni'>0</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>3</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>length</span><span class='hljl-oB'>=</span><span class='hljl-ni'>10</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>vs</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>range</span><span class='hljl-p'>(</span><span class='hljl-ni'>0</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>2</span><span class='hljl-n'>pi</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>length</span><span class='hljl-oB'>=</span><span class='hljl-ni'>10</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>xs</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>ys</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>zs</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>parametric_grid</span><span class='hljl-p'>(</span><span class='hljl-n'>us</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>vs</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>r</span><span class='hljl-p'>)</span><span class='hljl-t'>

</span><span class='hljl-n'>scene</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>Scene</span><span class='hljl-p'>()</span><span class='hljl-t'>
</span><span class='hljl-nf'>surface!</span><span class='hljl-p'>(</span><span class='hljl-n'>scene</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>xs</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>ys</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>zs</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>wireframe!</span><span class='hljl-p'>(</span><span class='hljl-n'>scene</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>xs</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>ys</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>zs</span><span class='hljl-p'>)</span>
</pre>



<p>A torus with big radius <span class="math">$2$</span> and inner radius <span class="math">$1/2$</span> can be visualized as follows</p>


<pre class='hljl'>
<span class='hljl-n'>r1</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>r2</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-ni'>2</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-oB'>/</span><span class='hljl-ni'>2</span><span class='hljl-t'>
</span><span class='hljl-nf'>r</span><span class='hljl-p'>(</span><span class='hljl-n'>u</span><span class='hljl-p'>,</span><span class='hljl-n'>v</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>((</span><span class='hljl-n'>r1</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-n'>r2</span><span class='hljl-oB'>*</span><span class='hljl-nf'>cos</span><span class='hljl-p'>(</span><span class='hljl-n'>v</span><span class='hljl-p'>))</span><span class='hljl-oB'>*</span><span class='hljl-nf'>cos</span><span class='hljl-p'>(</span><span class='hljl-n'>u</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-n'>r1</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-n'>r2</span><span class='hljl-oB'>*</span><span class='hljl-nf'>cos</span><span class='hljl-p'>(</span><span class='hljl-n'>v</span><span class='hljl-p'>))</span><span class='hljl-oB'>*</span><span class='hljl-nf'>sin</span><span class='hljl-p'>(</span><span class='hljl-n'>u</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-n'>r2</span><span class='hljl-oB'>*</span><span class='hljl-nf'>sin</span><span class='hljl-p'>(</span><span class='hljl-n'>v</span><span class='hljl-p'>))</span><span class='hljl-t'>
</span><span class='hljl-n'>us</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>vs</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>range</span><span class='hljl-p'>(</span><span class='hljl-ni'>0</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>2</span><span class='hljl-n'>pi</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>length</span><span class='hljl-oB'>=</span><span class='hljl-ni'>25</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>xs</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>ys</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>zs</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>parametric_grid</span><span class='hljl-p'>(</span><span class='hljl-n'>us</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>vs</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>r</span><span class='hljl-p'>)</span><span class='hljl-t'>

</span><span class='hljl-n'>scene</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>Scene</span><span class='hljl-p'>()</span><span class='hljl-t'>
</span><span class='hljl-nf'>surface!</span><span class='hljl-p'>(</span><span class='hljl-n'>scene</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>xs</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>ys</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>zs</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>wireframe!</span><span class='hljl-p'>(</span><span class='hljl-n'>scene</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>xs</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>ys</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>zs</span><span class='hljl-p'>)</span>
</pre>



<p>A Möbius strip can be produced with:</p>


<pre class='hljl'>
<span class='hljl-n'>ws</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>range</span><span class='hljl-p'>(</span><span class='hljl-oB'>-</span><span class='hljl-ni'>1</span><span class='hljl-oB'>/</span><span class='hljl-ni'>4</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-oB'>/</span><span class='hljl-ni'>4</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>length</span><span class='hljl-oB'>=</span><span class='hljl-ni'>8</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>thetas</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>range</span><span class='hljl-p'>(</span><span class='hljl-ni'>0</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>2</span><span class='hljl-n'>pi</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>length</span><span class='hljl-oB'>=</span><span class='hljl-ni'>30</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>r</span><span class='hljl-p'>(</span><span class='hljl-n'>w</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>θ</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>((</span><span class='hljl-ni'>1</span><span class='hljl-oB'>+</span><span class='hljl-n'>w</span><span class='hljl-oB'>*</span><span class='hljl-nf'>cos</span><span class='hljl-p'>(</span><span class='hljl-n'>θ</span><span class='hljl-oB'>/</span><span class='hljl-ni'>2</span><span class='hljl-p'>))</span><span class='hljl-oB'>*</span><span class='hljl-nf'>cos</span><span class='hljl-p'>(</span><span class='hljl-n'>θ</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-ni'>1</span><span class='hljl-oB'>+</span><span class='hljl-n'>w</span><span class='hljl-oB'>*</span><span class='hljl-nf'>cos</span><span class='hljl-p'>(</span><span class='hljl-n'>θ</span><span class='hljl-oB'>/</span><span class='hljl-ni'>2</span><span class='hljl-p'>))</span><span class='hljl-oB'>*</span><span class='hljl-nf'>sin</span><span class='hljl-p'>(</span><span class='hljl-n'>θ</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-n'>w</span><span class='hljl-oB'>*</span><span class='hljl-nf'>sin</span><span class='hljl-p'>(</span><span class='hljl-n'>θ</span><span class='hljl-oB'>/</span><span class='hljl-ni'>2</span><span class='hljl-p'>))</span><span class='hljl-t'>
</span><span class='hljl-n'>xs</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>ys</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>zs</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>parametric_grid</span><span class='hljl-p'>(</span><span class='hljl-n'>ws</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>thetas</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>r</span><span class='hljl-p'>)</span><span class='hljl-t'>

</span><span class='hljl-n'>scene</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>Scene</span><span class='hljl-p'>()</span><span class='hljl-t'>
</span><span class='hljl-nf'>surface!</span><span class='hljl-p'>(</span><span class='hljl-n'>scene</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>xs</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>ys</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>zs</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>wireframe!</span><span class='hljl-p'>(</span><span class='hljl-n'>scene</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>xs</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>ys</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>zs</span><span class='hljl-p'>)</span>
</pre>



<h2>Contour plots &#40;<code>contour</code>, <code>heatmap</code>&#41;</h2>
<p>For a function <span class="math">$z = f(x,y)$</span> an alternative to a surface plot, is a contour plot. That is, for different values of <span class="math">$c$</span> the level curves <span class="math">$f(x,y)=c$</span> are drawn.</p>
<p>For a function <span class="math">$f(x,y)$</span>, the syntax for generating a contour plot follows that for <code>surface</code>.</p>
<p>For example, using the <code>peaks</code> function, previously defined, we have a contour plot over the region <span class="math">$[-5,5]\times[-5,5]$</span> is generated through:</p>


<pre class='hljl'>
<span class='hljl-n'>xs</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>ys</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>range</span><span class='hljl-p'>(</span><span class='hljl-oB'>-</span><span class='hljl-ni'>5</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>5</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>length</span><span class='hljl-oB'>=</span><span class='hljl-ni'>100</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>contour</span><span class='hljl-p'>(</span><span class='hljl-n'>xs</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>ys</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>peaks</span><span class='hljl-p'>)</span>
</pre>



<p>The default of <span class="math">$5$</span> levels can be adjusted using the <code>levels</code> keyword:</p>


<pre class='hljl'>
<span class='hljl-nf'>contour</span><span class='hljl-p'>(</span><span class='hljl-n'>xs</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>ys</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>peaks</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>xs</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>ys</span><span class='hljl-oB'>&#39;</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-n'>levels</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-ni'>20</span><span class='hljl-p'>)</span>
</pre>



<p>&#40;As a reminder, the above also shows how to generate values &quot;<code>zs</code>&quot; to pass to <code>contour</code> instead of a function.&#41;</p>
<p>The contour graph makes identification of peaks and valleys easy as the limits of patterns of nested contour lines.</p>
<p>An alternative visualzation using color to replace contour lines is a heatmap. The <code>heatmap</code> function produces these. The calling syntax is similar to <code>contour</code> and <code>surface</code>:</p>


<pre class='hljl'>
<span class='hljl-nf'>heatmap</span><span class='hljl-p'>(</span><span class='hljl-n'>xs</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>ys</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>peaks</span><span class='hljl-p'>)</span>
</pre>



<p>This graph shows peaks and valleys through &quot;hotspots&quot; on the graph.</p>
<p>The <code>MakieGallery</code> package includes an example of a surface plot with both a wireframe and 2D contour graph added. It is replicated here using the <code>peaks</code> function scaled by <span class="math">$5$</span>.</p>
<p>The function and domain to plot are described by:</p>


<pre class='hljl'>
<span class='hljl-n'>xs</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>ys</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>range</span><span class='hljl-p'>(</span><span class='hljl-oB'>-</span><span class='hljl-ni'>5</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>5</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>length</span><span class='hljl-oB'>=</span><span class='hljl-ni'>51</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>zs</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>peaks</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>xs</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>ys</span><span class='hljl-oB'>&#39;</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>/</span><span class='hljl-t'> </span><span class='hljl-ni'>5</span><span class='hljl-p'>;</span>
</pre>



<p>The <code>zs</code> were generated, as <code>wireframe</code> does not provide the interface for passing a function.</p>
<p>The <code>surface</code> and <code>wireframe</code> are produced as follows:</p>


<pre class='hljl'>
<span class='hljl-n'>scene</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>surface</span><span class='hljl-p'>(</span><span class='hljl-n'>xs</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>ys</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>zs</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>wireframe!</span><span class='hljl-p'>(</span><span class='hljl-n'>scene</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>xs</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>ys</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>zs</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>overdraw</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-kc'>true</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>transparency</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-kc'>true</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>color</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-sc'>:black</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-nfB'>0.1</span><span class='hljl-p'>))</span>
</pre>



<p>To add the contour, a simple call via <code>contour&#33;&#40;scene, xs, ys, zs&#41;</code> will place the contour at the <span class="math">$z=0$</span> level which will make it hard to read. Rather, placing at the &quot;bottom&quot; of the scene is desirable. To identify that the &quot;scene limits&quot; are queried and the argument <code>transformation &#61; &#40;:xy, zmin&#41;</code> is passed to <code>contour&#33;</code>:</p>


<pre class='hljl'>
<span class='hljl-n'>xmin</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>ymin</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>zmin</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>minimum</span><span class='hljl-p'>(</span><span class='hljl-nf'>scene_limits</span><span class='hljl-p'>(</span><span class='hljl-n'>scene</span><span class='hljl-p'>))</span><span class='hljl-t'>
</span><span class='hljl-nf'>contour!</span><span class='hljl-p'>(</span><span class='hljl-n'>scene</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>xs</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>ys</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>zs</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>levels</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-ni'>15</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>linewidth</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-ni'>2</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>transformation</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-sc'>:xy</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>zmin</span><span class='hljl-p'>))</span><span class='hljl-t'>
</span><span class='hljl-nf'>center!</span><span class='hljl-p'>(</span><span class='hljl-n'>scene</span><span class='hljl-p'>)</span>
</pre>



<p>The <code>transformation</code> plot attribute sets the &quot;plane&quot; &#40;one of <code>:xy</code>, <code>:yz</code>, or <code>:xz</code>&#41; at a location, in this example <code>zmin</code>.</p>
<h3>Three dimensional contour plots</h3>
<p>The <code>contour</code> function can also plot <span class="math">$3$</span>-dimensional contour plots. Concentric spheres, contours of <span class="math">$x^2 + y^2 + z^2 = c$</span> for <span class="math">$c > 0$</span> are presented by the following:</p>


<pre class='hljl'>
<span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>,</span><span class='hljl-n'>y</span><span class='hljl-p'>,</span><span class='hljl-n'>z</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>x</span><span class='hljl-oB'>^</span><span class='hljl-ni'>2</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-n'>y</span><span class='hljl-oB'>^</span><span class='hljl-ni'>2</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-n'>z</span><span class='hljl-oB'>^</span><span class='hljl-ni'>2</span><span class='hljl-t'>
</span><span class='hljl-n'>xs</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>ys</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>zs</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>range</span><span class='hljl-p'>(</span><span class='hljl-oB'>-</span><span class='hljl-ni'>3</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>3</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>length</span><span class='hljl-oB'>=</span><span class='hljl-ni'>100</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>contour</span><span class='hljl-p'>(</span><span class='hljl-n'>xs</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>ys</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>zs</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>f</span><span class='hljl-p'>)</span>
</pre>



<h2>Vector fields. Visualizations of <span class="math">$f:R^2 \rightarrow R^2$</span></h2>
<p>The vector field <span class="math">$f(x,y) = (y, -x)$</span> can be visualized as a set of vectors, <span class="math">$f(x,y)$</span>, positioned at a grid. These can be produced with the <code>arrows</code> function. Below we pass a vector of points for the anchors and a vector of points representing the vectors.</p>
<p>We can generate these on a regular grid through:</p>


<pre class='hljl'>
<span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>y</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>[</span><span class='hljl-n'>y</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-n'>x</span><span class='hljl-p'>]</span><span class='hljl-t'>
</span><span class='hljl-n'>xs</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>ys</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-ni'>5</span><span class='hljl-oB'>:</span><span class='hljl-ni'>5</span><span class='hljl-t'>
</span><span class='hljl-n'>pts</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>vec</span><span class='hljl-p'>(</span><span class='hljl-n'>Point2</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>xs</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>ys</span><span class='hljl-oB'>&#39;</span><span class='hljl-p'>))</span><span class='hljl-t'>
</span><span class='hljl-n'>dus</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>vec</span><span class='hljl-p'>(</span><span class='hljl-n'>Point2</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>f</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>xs</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>ys</span><span class='hljl-oB'>&#39;</span><span class='hljl-p'>)))</span>
</pre>


<pre class="output">
121-element Array&#123;GeometryBasics.Point&#123;2,Int64&#125;,1&#125;:
 &#91;-5, 5&#93;
 &#91;-5, 4&#93;
 &#91;-5, 3&#93;
 &#91;-5, 2&#93;
 &#91;-5, 1&#93;
 &#91;-5, 0&#93;
 &#91;-5, -1&#93;
 &#91;-5, -2&#93;
 &#91;-5, -3&#93;
 &#91;-5, -4&#93;
 ⋮
 &#91;5, 3&#93;
 &#91;5, 2&#93;
 &#91;5, 1&#93;
 &#91;5, 0&#93;
 &#91;5, -1&#93;
 &#91;5, -2&#93;
 &#91;5, -3&#93;
 &#91;5, -4&#93;
 &#91;5, -5&#93;
</pre>


<p>Broadcasting over <code>&#40;xs, ys&#39;&#41;</code> ensures each pair of possible values is encountered. The <code>vec</code> call reshapes an array into a  vector.</p>
<p>Calling <code>arrows</code> on the prepared data produces the graphic:</p>


<pre class='hljl'>
<span class='hljl-nf'>arrows</span><span class='hljl-p'>(</span><span class='hljl-n'>pts</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>dus</span><span class='hljl-p'>)</span>
</pre>



<p>The grid seems rotated at first glance. This is due to the length of the vectors as the <span class="math">$(x,y)$</span> values get farther from the origin. Plotting the <em>normalized</em> values &#40;each will have length <span class="math">$1$</span>&#41; can be done easily using <code>norm</code> &#40;which requires <code>LinearAlgebra</code> to be loaded&#41;:</p>


<pre class='hljl'>
<span class='hljl-k'>using</span><span class='hljl-t'> </span><span class='hljl-n'>LinearAlgebra</span><span class='hljl-t'>
</span><span class='hljl-n'>dvs</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>dus</span><span class='hljl-t'> </span><span class='hljl-oB'>./</span><span class='hljl-t'> </span><span class='hljl-n'>norm</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>dus</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>arrows</span><span class='hljl-p'>(</span><span class='hljl-n'>pts</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>dvs</span><span class='hljl-p'>)</span>
</pre>



<p>The rotational pattern becomes quite clear now.</p>
<p>The <code>streamplot</code> function also illustrates this phenomenon. This implements an &quot;algorithm &#91;that&#93; puts an arrow somewhere and extends the streamline in both directions from there. Then, it chooses a new position &#40;from the remaining ones&#41;, repeating the the exercise until the streamline  gets blocked, from which on a new starting point, the process repeats.&quot;</p>
<p>The <code>streamplot</code> function expects a <code>point</code> not a pair of values, so we adjust <code>f</code> slightly and call the function using the pattern <code>streamplot&#40;f, xs, ys&#41;</code>:</p>


<pre class='hljl'>
<span class='hljl-nf'>g</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>,</span><span class='hljl-n'>y</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>Point2</span><span class='hljl-p'>(</span><span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>,</span><span class='hljl-n'>y</span><span class='hljl-p'>))</span><span class='hljl-t'>
</span><span class='hljl-nf'>streamplot</span><span class='hljl-p'>(</span><span class='hljl-n'>g</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>xs</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>ys</span><span class='hljl-p'>)</span>
</pre>


<pre class="julia-error">
ERROR: MethodError: no method matching ^&#40;::GeometryBasics.Point&#123;2,Float64&#125;, ::Int64&#41;
Closest candidates are:
  ^&#40;&#33;Matched::Regex, ::Integer&#41; at regex.jl:729
  ^&#40;&#33;Matched::SymMatrix, ::Union&#123;Int64, SymPy.SymbolicObject&#125;&#41; at /Users/verzani/julia/SymPy/src/matrix.jl:123
  ^&#40;&#33;Matched::BigInt, ::Integer&#41; at gmp.jl:602
  ...
</pre>


<p>&#40;The viewing range could also be adjusted with the <code>-5..5</code> notation from the <code>IntervalSets</code> package which is brought in when <code>AbstractPlotting</code> is loaded.&#41;</p>
<h2>Interacting with a scene</h2>
<p><a href="http://makie.juliaplots.org/stable/interaction.html">Interaction</a> with a scene is very much integrated into <code>Makie</code>, as the design has a &quot;sophisticated referencing system&quot; which allows sharing of attributes. Adjusting one attribute, can then propogate to others.</p>
<p>In Makie, a <code>Node</code> is a structure that allows its value to be updated, similar to an array. Nodes are <code>Observables</code>, which when changed can trigger an event. Nodes can rely on other nodes, so events can be cascaded.</p>
<p>A simple example is a means to dynamically adjust a label for a scene.</p>
<pre><code>xs, &#61; 1:5, rand&#40;5&#41;
scene &#61; scatter&#40;xs, ys&#41;</code></pre>
<p>We can create a &quot;Node&quot; through:</p>
<pre><code>x &#61; Node&#40;&quot;x values&quot;&#41;</code></pre>
<p>The value of the node is retrieved by <code>x&#91;&#93;</code>, though the function call <code>to_value&#40;x&#41;</code> is recommened, as it will be defined even when <code>x</code> is not a node. This stored value could be used to set the <span class="math">$x$</span>-label in our scene:</p>
<pre><code>xlabel&#33;&#40;scene, x&#91;&#93;&#41;</code></pre>
<p>We now set up an observer to update the label whenever the value of <code>x</code> is updated:</p>
<pre><code>on&#40;x&#41; do val
   xlabel&#33;&#40;scen, val&#41;
end</code></pre>
<p>Now setting the value of <code>x</code> will also update the label:</p>
<pre><code>x&#91;&#93; &#61; &quot;The x axis&quot;</code></pre>
<p>A node can be more complicated. This shows how a node of <span class="math">$x$</span> value can be used to define dependent <span class="math">$y$</span> values. A scatter plot will update when the <span class="math">$x$</span> values are updated:</p>
<pre><code>xs &#61; Node&#40;1:10&#41;
ys &#61; lift&#40;a -&gt; f.&#40;a&#41;, xs&#41;</code></pre>
<p>The <code>lift</code> function lifts the values of <code>xs</code> to the values of <code>ys</code>.</p>
<p>These can be plotted directly:</p>
<pre><code>scene &#61;  lines&#40;xs, ys&#41;</code></pre>
<p>Changes to the <code>xs</code> values will be reflected in the <code>scene</code>.</p>
<pre><code>xs&#91;&#93; &#61; 2:9</code></pre>
<p>We can incoporporate the two:</p>
<pre><code>lab &#61; lift&#40;val -&gt; &quot;Showing from &#36;&#40;val.start&#41; to &#36;&#40;val.stop&#41;&quot;, xs&#41;
on&#40;lab&#41; do val
  xlabel&#33;&#40;scene, val&#41;
  udpate&#33;&#40;scene&#41;
end</code></pre>
<p>The <code>update&#33;</code> call redraws the scene to adjust to increased or decreased range of <span class="math">$x$</span> values.</p>
<p>The mouse position can be recorded. An example in the gallery of examples shows how.</p>
<p>Here is a hint:</p>
<pre><code>scene &#61; lines&#40;1:5, rand&#40;5&#41;&#41;
pos &#61; lift&#40;scene.events.mouseposition&#41; do mpos
    @show AbstractPlotting.to_world&#40;scene, Point2f0&#40;mpos&#41;&#41;
end</code></pre>
<p>This will display the coordinates of the mouse in the terminal, as the mouse is moved around.</p>

  </div>
</div>

</body>
</html>
